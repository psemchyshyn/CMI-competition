Global seed set to 42
[2023-11-07 09:26:13,707][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231107_092614-x1ey26l7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet++
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/x1ey26l7
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type              â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN         â”‚ 43.6 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram    â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ UnetPlusPlus      â”‚ 26.1 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder     â”‚ 17.5 M â”‚
â”‚ 4 â”‚ model.loss_fn           â”‚ BCEWithLogitsLoss â”‚      0 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 43.6 M                                                        
Non-trainable params: 0                                                         
Total params: 43.6 M                                                            
Total estimated model params size (MB): 174                                     
Epoch 0, global step 119: 'val_loss' reached 0.05733 (best 0.05733), saving model to './child-mind-institute-detect-sleep-states/x1ey26l7/checkpoints/epoch=0-step=119.ckpt' as top 1
Saved best model inf -> 0.05727474274890904
Epoch 1, global step 238: 'val_loss' reached 0.04628 (best 0.04628), saving model to './child-mind-institute-detect-sleep-states/x1ey26l7/checkpoints/epoch=1-step=238.ckpt' as top 1
Saved best model 0.05727474274890904 -> 0.04630894854738815
Epoch 2, global step 357: 'val_loss' reached 0.04411 (best 0.04411), saving model to './child-mind-institute-detect-sleep-states/x1ey26l7/checkpoints/epoch=2-step=357.ckpt' as top 1
Saved best model 0.04630894854738815 -> 0.04408201778813309
Epoch 3, global step 476: 'val_loss' reached 0.03407 (best 0.03407), saving model to './child-mind-institute-detect-sleep-states/x1ey26l7/checkpoints/epoch=3-step=476.ckpt' as top 1
Saved best model 0.04408201778813309 -> 0.03406608187815557
Epoch 4, global step 595: 'val_loss' was not in top 1
Epoch 5, global step 714: 'val_loss' reached 0.03269 (best 0.03269), saving model to './child-mind-institute-detect-sleep-states/x1ey26l7/checkpoints/epoch=5-step=714.ckpt' as top 1
Saved best model 0.03406608187815557 -> 0.032692333029595434
Epoch 6, global step 833: 'val_loss' was not in top 1
Epoch 7, global step 952: 'val_loss' was not in top 1
Epoch 8, global step 1071: 'val_loss' was not in top 1
Epoch 9, global step 1190: 'val_loss' was not in top 1
Epoch 10, global step 1309: 'val_loss' reached 0.03183 (best 0.03183), saving model to './child-mind-institute-detect-sleep-states/x1ey26l7/checkpoints/epoch=10-step=1309.ckpt' as top 1
Saved best model 0.032692333029595434 -> 0.03184358330770389
Epoch 11, global step 1428: 'val_loss' was not in top 1
Epoch 12, global step 1547: 'val_loss' reached 0.02789 (best 0.02789), saving model to './child-mind-institute-detect-sleep-states/x1ey26l7/checkpoints/epoch=12-step=1547.ckpt' as top 1
Saved best model 0.03184358330770389 -> 0.02790713772819137
Epoch 13, global step 1666: 'val_loss' was not in top 1
Epoch 14, global step 1785: 'val_loss' was not in top 1
Epoch 15, global step 1904: 'val_loss' was not in top 1
Epoch 16, global step 2023: 'val_loss' was not in top 1
Epoch 17, global step 2142: 'val_loss' was not in top 1
Epoch 18, global step 2261: 'val_loss' was not in top 1
Epoch 19, global step 2380: 'val_loss' was not in top 1
Epoch 20, global step 2499: 'val_loss' reached 0.02687 (best 0.02687), saving model to './child-mind-institute-detect-sleep-states/x1ey26l7/checkpoints/epoch=20-step=2499.ckpt' as top 1
Saved best model 0.02790713772819137 -> 0.026879085201634376
Epoch 21, global step 2618: 'val_loss' was not in top 1
Epoch 22, global step 2737: 'val_loss' was not in top 1
Epoch 23, global step 2856: 'val_loss' was not in top 1
Epoch 24, global step 2975: 'val_loss' was not in top 1
Epoch 25, global step 3094: 'val_loss' was not in top 1
Epoch 26, global step 3213: 'val_loss' was not in top 1
Epoch 27, global step 3332: 'val_loss' reached 0.02675 (best 0.02675), saving model to './child-mind-institute-detect-sleep-states/x1ey26l7/checkpoints/epoch=27-step=3332.ckpt' as top 1
Saved best model 0.026879085201634376 -> 0.026752564998263405
Epoch 28, global step 3451: 'val_loss' was not in top 1
Epoch 29, global step 3570: 'val_loss' was not in top 1
Epoch 30, global step 3689: 'val_loss' was not in top 1
Epoch 31, global step 3808: 'val_loss' reached 0.02572 (best 0.02572), saving model to './child-mind-institute-detect-sleep-states/x1ey26l7/checkpoints/epoch=31-step=3808.ckpt' as top 1
Saved best model 0.026752564998263405 -> 0.025727632944703423
Epoch 32, global step 3927: 'val_loss' was not in top 1
Epoch 33, global step 4046: 'val_loss' was not in top 1
Epoch 34, global step 4165: 'val_loss' was not in top 1
Epoch 35, global step 4284: 'val_loss' was not in top 1
Epoch 36, global step 4403: 'val_loss' was not in top 1
Epoch 37, global step 4522: 'val_loss' reached 0.02437 (best 0.02437), saving model to './child-mind-institute-detect-sleep-states/x1ey26l7/checkpoints/epoch=37-step=4522.ckpt' as top 1
Saved best model 0.025727632944703423 -> 0.024376249507482822
Epoch 38, global step 4641: 'val_loss' was not in top 1
Epoch 39, global step 4760: 'val_loss' was not in top 1
Epoch 40, global step 4879: 'val_loss' was not in top 1
Epoch 41, global step 4998: 'val_loss' was not in top 1
Epoch 42, global step 5117: 'val_loss' was not in top 1
Epoch 43, global step 5236: 'val_loss' was not in top 1
Epoch 44, global step 5355: 'val_loss' was not in top 1
Epoch 45, global step 5474: 'val_loss' was not in top 1
Epoch 46, global step 5593: 'val_loss' was not in top 1
Epoch 47, global step 5712: 'val_loss' was not in top 1
Epoch 48, global step 5831: 'val_loss' was not in top 1
Epoch 49, global step 5950: 'val_loss' was not in top 1
Epoch 50, global step 6069: 'val_loss' was not in top 1
Epoch 51, global step 6188: 'val_loss' was not in top 1
Epoch 52, global step 6307: 'val_loss' was not in top 1
Epoch 53, global step 6426: 'val_loss' was not in top 1
Epoch 54, global step 6545: 'val_loss' was not in top 1
Epoch 55, global step 6664: 'val_loss' was not in top 1
Epoch 56, global step 6783: 'val_loss' was not in top 1
Epoch 57, global step 6902: 'val_loss' was not in top 1
Epoch 58, global step 7021: 'val_loss' was not in top 1
Epoch 59, global step 7140: 'val_loss' was not in top 1
Epoch 60, global step 7259: 'val_loss' was not in top 1
Epoch 61, global step 7378: 'val_loss' was not in top 1
Epoch 62, global step 7497: 'val_loss' was not in top 1
Epoch 63, global step 7616: 'val_loss' was not in top 1
Epoch 64, global step 7735: 'val_loss' reached 0.02432 (best 0.02432), saving model to './child-mind-institute-detect-sleep-states/x1ey26l7/checkpoints/epoch=64-step=7735.ckpt' as top 1
Saved best model 0.024376249507482822 -> 0.024331668992017993
Epoch 65, global step 7854: 'val_loss' was not in top 1
Epoch 66, global step 7973: 'val_loss' reached 0.02409 (best 0.02409), saving model to './child-mind-institute-detect-sleep-states/x1ey26l7/checkpoints/epoch=66-step=7973.ckpt' as top 1
Saved best model 0.024331668992017993 -> 0.024103963047586725
Epoch 67, global step 8092: 'val_loss' was not in top 1
Epoch 68, global step 8211: 'val_loss' reached 0.02398 (best 0.02398), saving model to './child-mind-institute-detect-sleep-states/x1ey26l7/checkpoints/epoch=68-step=8211.ckpt' as top 1
Saved best model 0.024103963047586725 -> 0.023983280648190577
Epoch 69, global step 8330: 'val_loss' was not in top 1
Epoch 70, global step 8449: 'val_loss' was not in top 1
Epoch 71, global step 8568: 'val_loss' was not in top 1
Epoch 72, global step 8687: 'val_loss' was not in top 1
Epoch 73, global step 8806: 'val_loss' was not in top 1
Epoch 74, global step 8925: 'val_loss' was not in top 1
Epoch 75, global step 9044: 'val_loss' was not in top 1
Epoch 76, global step 9163: 'val_loss' was not in top 1
Epoch 77, global step 9282: 'val_loss' was not in top 1
Epoch 78, global step 9401: 'val_loss' was not in top 1
Epoch 79, global step 9520: 'val_loss' was not in top 1
`Trainer.fit` stopped: `max_steps=9520` reached.
Epoch 79/79 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 119/119 0:00:56 â€¢        2.18it/s v_num: 26l7      
                                     0:00:00                   val_loss: 0.024  
                                                               val_score: 0.737 
                                                               train_loss: 0.154
[2023-11-07 11:15:34,999][train.py][INFO] - Extracting and saving best weights: model_weights.pth
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:               epoch â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            lr-AdamW â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–‡â–†â–†â–†â–†â–…â–…â–…â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–
wandb:          train_loss â–ˆâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–‚â–â–â–â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb: trainer/global_step â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            val_loss â–ˆâ–…â–„â–ƒâ–ƒâ–ƒâ–‚â–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–‚â–‚â–‚â–â–â–‚â–â–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–
wandb:           val_score â–â–ƒâ–ƒâ–„â–„â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb: 
wandb: Run summary:
wandb:               epoch 79
wandb:            lr-AdamW 0.0
wandb:          train_loss 0.15409
wandb: trainer/global_step 9519
wandb:            val_loss 0.02449
wandb:           val_score 0.73667
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet++ at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/x1ey26l7
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231107_092614-x1ey26l7/logs
Global seed set to 42
[2023-11-07 11:24:28,245][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231107_112429-x0esk8ea
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/x0esk8ea
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type              â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN         â”‚ 41.9 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram    â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet              â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder     â”‚ 17.5 M â”‚
â”‚ 4 â”‚ model.loss_fn           â”‚ BCEWithLogitsLoss â”‚      0 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 41.9 M                                                        
Non-trainable params: 0                                                         
Total params: 41.9 M                                                            
Total estimated model params size (MB): 167                                     
Epoch 0, global step 119: 'val_loss' reached 0.05295 (best 0.05295), saving model to './child-mind-institute-detect-sleep-states/x0esk8ea/checkpoints/epoch=0-step=119.ckpt' as top 1
Saved best model inf -> 0.052896184075796444
Epoch 1, global step 238: 'val_loss' was not in top 1
Epoch 2, global step 357: 'val_loss' reached 0.04231 (best 0.04231), saving model to './child-mind-institute-detect-sleep-states/x0esk8ea/checkpoints/epoch=2-step=357.ckpt' as top 1
Saved best model 0.052896184075796444 -> 0.042274823877960443
Epoch 3, global step 476: 'val_loss' reached 0.03972 (best 0.03972), saving model to './child-mind-institute-detect-sleep-states/x0esk8ea/checkpoints/epoch=3-step=476.ckpt' as top 1
Saved best model 0.042274823877960443 -> 0.03971988273729009
Epoch 4, global step 595: 'val_loss' reached 0.03123 (best 0.03123), saving model to './child-mind-institute-detect-sleep-states/x0esk8ea/checkpoints/epoch=4-step=595.ckpt' as top 1
Saved best model 0.03971988273729009 -> 0.031233797141270624
Epoch 5, global step 714: 'val_loss' was not in top 1
Epoch 6, global step 833: 'val_loss' was not in top 1
Epoch 7, global step 952: 'val_loss' was not in top 1
Epoch 8, global step 1071: 'val_loss' was not in top 1
Epoch 9, global step 1190: 'val_loss' reached 0.03100 (best 0.03100), saving model to './child-mind-institute-detect-sleep-states/x0esk8ea/checkpoints/epoch=9-step=1190.ckpt' as top 1
Saved best model 0.031233797141270624 -> 0.031002178967048395
Epoch 10, global step 1309: 'val_loss' reached 0.02884 (best 0.02884), saving model to './child-mind-institute-detect-sleep-states/x0esk8ea/checkpoints/epoch=10-step=1309.ckpt' as top 1
Saved best model 0.031002178967048395 -> 0.028825988552058177
Epoch 11, global step 1428: 'val_loss' was not in top 1
Epoch 12, global step 1547: 'val_loss' was not in top 1
Epoch 13, global step 1666: 'val_loss' was not in top 1
Epoch 14, global step 1785: 'val_loss' was not in top 1
Epoch 15, global step 1904: 'val_loss' was not in top 1
Epoch 16, global step 2023: 'val_loss' was not in top 1
Epoch 17, global step 2142: 'val_loss' reached 0.02855 (best 0.02855), saving model to './child-mind-institute-detect-sleep-states/x0esk8ea/checkpoints/epoch=17-step=2142.ckpt' as top 1
Saved best model 0.028825988552058177 -> 0.028537365072869407
Epoch 18, global step 2261: 'val_loss' was not in top 1
Epoch 19, global step 2380: 'val_loss' was not in top 1
Epoch 20, global step 2499: 'val_loss' was not in top 1
Epoch 21, global step 2618: 'val_loss' was not in top 1
Epoch 22, global step 2737: 'val_loss' was not in top 1
Epoch 23, global step 2856: 'val_loss' was not in top 1
Epoch 24, global step 2975: 'val_loss' reached 0.02698 (best 0.02698), saving model to './child-mind-institute-detect-sleep-states/x0esk8ea/checkpoints/epoch=24-step=2975.ckpt' as top 1
Saved best model 0.028537365072869407 -> 0.026997412591925916
Epoch 25, global step 3094: 'val_loss' was not in top 1
Epoch 26, global step 3213: 'val_loss' was not in top 1
Epoch 27, global step 3332: 'val_loss' reached 0.02605 (best 0.02605), saving model to './child-mind-institute-detect-sleep-states/x0esk8ea/checkpoints/epoch=27-step=3332.ckpt' as top 1
Saved best model 0.026997412591925916 -> 0.026057722379256115
Epoch 28, global step 3451: 'val_loss' was not in top 1
Epoch 29, global step 3570: 'val_loss' was not in top 1
Epoch 30, global step 3689: 'val_loss' was not in top 1
Epoch 31, global step 3808: 'val_loss' reached 0.02598 (best 0.02598), saving model to './child-mind-institute-detect-sleep-states/x0esk8ea/checkpoints/epoch=31-step=3808.ckpt' as top 1
Saved best model 0.026057722379256115 -> 0.025985706384780982
Epoch 32, global step 3927: 'val_loss' was not in top 1
Epoch 33, global step 4046: 'val_loss' was not in top 1
Epoch 34, global step 4165: 'val_loss' was not in top 1
Epoch 35, global step 4284: 'val_loss' was not in top 1
Epoch 36, global step 4403: 'val_loss' was not in top 1
Epoch 37, global step 4522: 'val_loss' was not in top 1
Epoch 38, global step 4641: 'val_loss' was not in top 1
Epoch 39, global step 4760: 'val_loss' was not in top 1
Epoch 40, global step 4879: 'val_loss' reached 0.02548 (best 0.02548), saving model to './child-mind-institute-detect-sleep-states/x0esk8ea/checkpoints/epoch=40-step=4879.ckpt' as top 1
Saved best model 0.025985706384780982 -> 0.025500728165891193
Epoch 41, global step 4998: 'val_loss' was not in top 1
Epoch 42, global step 5117: 'val_loss' reached 0.02493 (best 0.02493), saving model to './child-mind-institute-detect-sleep-states/x0esk8ea/checkpoints/epoch=42-step=5117.ckpt' as top 1
Saved best model 0.025500728165891193 -> 0.024942378091027603
Epoch 43, global step 5236: 'val_loss' was not in top 1
Epoch 44, global step 5355: 'val_loss' was not in top 1
Epoch 45, global step 5474: 'val_loss' was not in top 1
Epoch 46, global step 5593: 'val_loss' was not in top 1
Epoch 47, global step 5712: 'val_loss' was not in top 1
Epoch 48, global step 5831: 'val_loss' was not in top 1
Epoch 49, global step 5950: 'val_loss' was not in top 1
Epoch 50, global step 6069: 'val_loss' was not in top 1
Epoch 51, global step 6188: 'val_loss' was not in top 1
Epoch 52, global step 6307: 'val_loss' was not in top 1
Epoch 53, global step 6426: 'val_loss' was not in top 1
Epoch 54, global step 6545: 'val_loss' was not in top 1
Epoch 55, global step 6664: 'val_loss' was not in top 1
Epoch 56, global step 6783: 'val_loss' was not in top 1
Epoch 57, global step 6902: 'val_loss' was not in top 1
Epoch 58, global step 7021: 'val_loss' was not in top 1
Epoch 59, global step 7140: 'val_loss' was not in top 1
Epoch 60, global step 7259: 'val_loss' was not in top 1
Epoch 61, global step 7378: 'val_loss' was not in top 1
Epoch 62, global step 7497: 'val_loss' was not in top 1
Epoch 63, global step 7616: 'val_loss' reached 0.02473 (best 0.02473), saving model to './child-mind-institute-detect-sleep-states/x0esk8ea/checkpoints/epoch=63-step=7616.ckpt' as top 1
Saved best model 0.024942378091027603 -> 0.024734759919918976
Epoch 64, global step 7735: 'val_loss' was not in top 1
Epoch 65, global step 7854: 'val_loss' was not in top 1
Epoch 66, global step 7973: 'val_loss' reached 0.02368 (best 0.02368), saving model to './child-mind-institute-detect-sleep-states/x0esk8ea/checkpoints/epoch=66-step=7973.ckpt' as top 1
Saved best model 0.024734759919918976 -> 0.023688367053339047
Epoch 67, global step 8092: 'val_loss' was not in top 1
Epoch 68, global step 8211: 'val_loss' was not in top 1
Epoch 69, global step 8330: 'val_loss' was not in top 1
Epoch 70, global step 8449: 'val_loss' was not in top 1
Epoch 71, global step 8568: 'val_loss' was not in top 1
Epoch 72, global step 8687: 'val_loss' was not in top 1
Epoch 73, global step 8806: 'val_loss' was not in top 1
Epoch 74, global step 8925: 'val_loss' was not in top 1
Epoch 75, global step 9044: 'val_loss' was not in top 1
Epoch 76, global step 9163: 'val_loss' was not in top 1
Epoch 77, global step 9282: 'val_loss' was not in top 1
Epoch 78, global step 9401: 'val_loss' was not in top 1
Epoch 79, global step 9520: 'val_loss' was not in top 1
`Trainer.fit` stopped: `max_steps=9520` reached.
Epoch 79/79 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 119/119 0:00:33 â€¢        3.88it/s v_num: k8ea      
                                     0:00:00                   val_loss: 0.025  
                                                               val_score: 0.747 
                                                               train_loss: 0.155
[2023-11-07 12:27:03,445][train.py][INFO] - Extracting and saving best weights: model_weights.pth
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:               epoch â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            lr-AdamW â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–‡â–†â–†â–†â–†â–…â–…â–…â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–
wandb:          train_loss â–ˆâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb: trainer/global_step â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            val_loss â–ˆâ–…â–ƒâ–„â–ƒâ–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–‚â–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–â–â–‚â–‚â–‚â–â–‚â–â–‚â–‚â–â–â–‚â–â–â–â–â–â–â–
wandb:           val_score â–â–„â–„â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb: 
wandb: Run summary:
wandb:               epoch 79
wandb:            lr-AdamW 0.0
wandb:          train_loss 0.15453
wandb: trainer/global_step 9519
wandb:            val_loss 0.02454
wandb:           val_score 0.74657
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/x0esk8ea
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231107_112429-x0esk8ea/logs
Global seed set to 42
[2023-11-07 12:36:30,467][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231107_123631-ev0fadt2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet_batch_size_64
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/ev0fadt2
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type              â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN         â”‚ 41.9 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram    â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet              â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder     â”‚ 17.5 M â”‚
â”‚ 4 â”‚ model.loss_fn           â”‚ BCEWithLogitsLoss â”‚      0 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 41.9 M                                                        
Non-trainable params: 0                                                         
Total params: 41.9 M                                                            
Total estimated model params size (MB): 167                                     
Epoch 0, global step 59: 'val_loss' reached 0.08050 (best 0.08050), saving model to './child-mind-institute-detect-sleep-states/ev0fadt2/checkpoints/epoch=0-step=59.ckpt' as top 1
Saved best model inf -> 0.08030438160915908
Epoch 1, global step 118: 'val_loss' reached 0.04746 (best 0.04746), saving model to './child-mind-institute-detect-sleep-states/ev0fadt2/checkpoints/epoch=1-step=118.ckpt' as top 1
Saved best model 0.08030438160915908 -> 0.0473943111290665
Epoch 2, global step 177: 'val_loss' reached 0.04517 (best 0.04517), saving model to './child-mind-institute-detect-sleep-states/ev0fadt2/checkpoints/epoch=2-step=177.ckpt' as top 1
Saved best model 0.0473943111290665 -> 0.04508735543411029
Epoch 3, global step 236: 'val_loss' reached 0.03995 (best 0.03995), saving model to './child-mind-institute-detect-sleep-states/ev0fadt2/checkpoints/epoch=3-step=236.ckpt' as top 1
Saved best model 0.04508735543411029 -> 0.039861110179979155
Epoch 4, global step 295: 'val_loss' reached 0.03558 (best 0.03558), saving model to './child-mind-institute-detect-sleep-states/ev0fadt2/checkpoints/epoch=4-step=295.ckpt' as top 1
Saved best model 0.039861110179979155 -> 0.035555505310185254
Epoch 5, global step 354: 'val_loss' reached 0.03214 (best 0.03214), saving model to './child-mind-institute-detect-sleep-states/ev0fadt2/checkpoints/epoch=5-step=354.ckpt' as top 1
Saved best model 0.035555505310185254 -> 0.03215794646377234
Epoch 6, global step 413: 'val_loss' reached 0.03196 (best 0.03196), saving model to './child-mind-institute-detect-sleep-states/ev0fadt2/checkpoints/epoch=6-step=413.ckpt' as top 1
Saved best model 0.03215794646377234 -> 0.03194704772230532
Epoch 7, global step 472: 'val_loss' was not in top 1
Epoch 8, global step 531: 'val_loss' was not in top 1
Epoch 9, global step 590: 'val_loss' was not in top 1
Epoch 10, global step 649: 'val_loss' reached 0.03075 (best 0.03075), saving model to './child-mind-institute-detect-sleep-states/ev0fadt2/checkpoints/epoch=10-step=649.ckpt' as top 1
Saved best model 0.03194704772230532 -> 0.030729625692689104
Epoch 11, global step 708: 'val_loss' was not in top 1
Epoch 12, global step 767: 'val_loss' reached 0.02819 (best 0.02819), saving model to './child-mind-institute-detect-sleep-states/ev0fadt2/checkpoints/epoch=12-step=767.ckpt' as top 1
Saved best model 0.030729625692689104 -> 0.02819742796954846
Epoch 13, global step 826: 'val_loss' was not in top 1
Epoch 14, global step 885: 'val_loss' was not in top 1
Epoch 15, global step 944: 'val_loss' was not in top 1
Epoch 16, global step 1003: 'val_loss' reached 0.02804 (best 0.02804), saving model to './child-mind-institute-detect-sleep-states/ev0fadt2/checkpoints/epoch=16-step=1003.ckpt' as top 1
Saved best model 0.02819742796954846 -> 0.02803185073916163
Epoch 17, global step 1062: 'val_loss' was not in top 1
Epoch 18, global step 1121: 'val_loss' was not in top 1
Epoch 19, global step 1180: 'val_loss' was not in top 1
Epoch 20, global step 1239: 'val_loss' reached 0.02593 (best 0.02593), saving model to './child-mind-institute-detect-sleep-states/ev0fadt2/checkpoints/epoch=20-step=1239.ckpt' as top 1
Saved best model 0.02803185073916163 -> 0.025908931838593593
Epoch 21, global step 1298: 'val_loss' was not in top 1
Epoch 22, global step 1357: 'val_loss' was not in top 1
Epoch 23, global step 1416: 'val_loss' was not in top 1
Epoch 24, global step 1475: 'val_loss' was not in top 1
Epoch 25, global step 1534: 'val_loss' was not in top 1
Epoch 26, global step 1593: 'val_loss' was not in top 1
Epoch 27, global step 1652: 'val_loss' was not in top 1
Epoch 28, global step 1711: 'val_loss' was not in top 1
Epoch 29, global step 1770: 'val_loss' was not in top 1
Epoch 30, global step 1829: 'val_loss' was not in top 1
Epoch 31, global step 1888: 'val_loss' was not in top 1
Epoch 32, global step 1947: 'val_loss' was not in top 1
Epoch 33, global step 2006: 'val_loss' was not in top 1
Epoch 34, global step 2065: 'val_loss' was not in top 1
Epoch 35, global step 2124: 'val_loss' reached 0.02522 (best 0.02522), saving model to './child-mind-institute-detect-sleep-states/ev0fadt2/checkpoints/epoch=35-step=2124.ckpt' as top 1
Saved best model 0.025908931838593593 -> 0.025270982657706265
Epoch 36, global step 2183: 'val_loss' was not in top 1
Epoch 37, global step 2242: 'val_loss' was not in top 1
Epoch 38, global step 2301: 'val_loss' was not in top 1
Epoch 39, global step 2360: 'val_loss' reached 0.02493 (best 0.02493), saving model to './child-mind-institute-detect-sleep-states/ev0fadt2/checkpoints/epoch=39-step=2360.ckpt' as top 1
Saved best model 0.025270982657706265 -> 0.024974597288651
Epoch 40, global step 2419: 'val_loss' was not in top 1
Epoch 41, global step 2478: 'val_loss' was not in top 1
Epoch 42, global step 2537: 'val_loss' was not in top 1
Saved best model 0.024974597288651 -> 0.024951344911977157
Epoch 43, global step 2596: 'val_loss' was not in top 1
Epoch 44, global step 2655: 'val_loss' was not in top 1
Epoch 45, global step 2714: 'val_loss' was not in top 1
Epoch 46, global step 2773: 'val_loss' was not in top 1
Epoch 47, global step 2832: 'val_loss' was not in top 1
Epoch 48, global step 2891: 'val_loss' reached 0.02493 (best 0.02493), saving model to './child-mind-institute-detect-sleep-states/ev0fadt2/checkpoints/epoch=48-step=2891.ckpt' as top 1
Epoch 49, global step 2950: 'val_loss' was not in top 1
Epoch 50, global step 3009: 'val_loss' was not in top 1
Epoch 51, global step 3068: 'val_loss' was not in top 1
Epoch 52, global step 3127: 'val_loss' was not in top 1
Saved best model 0.024951344911977157 -> 0.02494182367962295
Epoch 53, global step 3186: 'val_loss' was not in top 1
Epoch 54, global step 3245: 'val_loss' was not in top 1
Epoch 55, global step 3304: 'val_loss' was not in top 1
Epoch 56, global step 3363: 'val_loss' was not in top 1
Epoch 57, global step 3422: 'val_loss' reached 0.02371 (best 0.02371), saving model to './child-mind-institute-detect-sleep-states/ev0fadt2/checkpoints/epoch=57-step=3422.ckpt' as top 1
Saved best model 0.02494182367962295 -> 0.023720241554608373
Epoch 58, global step 3481: 'val_loss' was not in top 1
Epoch 59, global step 3540: 'val_loss' was not in top 1
Epoch 60, global step 3599: 'val_loss' reached 0.02349 (best 0.02349), saving model to './child-mind-institute-detect-sleep-states/ev0fadt2/checkpoints/epoch=60-step=3599.ckpt' as top 1
Saved best model 0.023720241554608373 -> 0.023447968502296135
Epoch 61, global step 3658: 'val_loss' reached 0.02348 (best 0.02348), saving model to './child-mind-institute-detect-sleep-states/ev0fadt2/checkpoints/epoch=61-step=3658.ckpt' as top 1
Epoch 62, global step 3717: 'val_loss' was not in top 1
Epoch 63, global step 3776: 'val_loss' was not in top 1
Epoch 64, global step 3835: 'val_loss' reached 0.02318 (best 0.02318), saving model to './child-mind-institute-detect-sleep-states/ev0fadt2/checkpoints/epoch=64-step=3835.ckpt' as top 1
Saved best model 0.023447968502296135 -> 0.02316683898358238
Epoch 65, global step 3894: 'val_loss' was not in top 1
Epoch 66, global step 3953: 'val_loss' was not in top 1
Epoch 67, global step 4012: 'val_loss' was not in top 1
Epoch 68, global step 4071: 'val_loss' was not in top 1
Epoch 69, global step 4130: 'val_loss' was not in top 1
Epoch 70, global step 4189: 'val_loss' was not in top 1
Epoch 71, global step 4248: 'val_loss' was not in top 1
Epoch 72, global step 4307: 'val_loss' was not in top 1
Epoch 73, global step 4366: 'val_loss' was not in top 1
Epoch 74, global step 4425: 'val_loss' was not in top 1
Epoch 75, global step 4484: 'val_loss' was not in top 1
Epoch 76, global step 4543: 'val_loss' was not in top 1
Epoch 77, global step 4602: 'val_loss' was not in top 1
Epoch 78, global step 4661: 'val_loss' was not in top 1
Epoch 79, global step 4720: 'val_loss' was not in top 1
`Trainer.fit` stopped: `max_steps=4720` reached.
Epoch 79/79 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 59/59 0:00:31 â€¢ 0:00:00 2.15it/s v_num: adt2      
                                                               val_loss: 0.024  
                                                               val_score: 0.73  
                                                               train_loss: 0.154
[2023-11-07 13:38:25,944][train.py][INFO] - Extracting and saving best weights: model_weights.pth
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.018 MB of 0.018 MB uploaded (0.000 MB deduped)wandb: | 0.018 MB of 0.018 MB uploaded (0.000 MB deduped)wandb:                                                                                
wandb: 
wandb: Run history:
wandb:               epoch â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            lr-AdamW â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–‡â–†â–†â–†â–†â–…â–…â–…â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–
wandb:          train_loss â–ˆâ–‚â–‚â–‚â–‚â–‚â–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb: trainer/global_step â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            val_loss â–ˆâ–„â–ƒâ–‚â–ƒâ–‚â–‚â–‚â–‚â–‚â–â–‚â–‚â–‚â–â–‚â–‚â–‚â–â–â–â–â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb:           val_score â–â–‚â–ƒâ–„â–ƒâ–„â–„â–„â–…â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb: 
wandb: Run summary:
wandb:               epoch 79
wandb:            lr-AdamW 0.0
wandb:          train_loss 0.15363
wandb: trainer/global_step 4719
wandb:            val_loss 0.02443
wandb:           val_score 0.73027
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet_batch_size_64 at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/ev0fadt2
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231107_123631-ev0fadt2/logs
python: can't open file '/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/train.py': [Errno 2] No such file or directory
Global seed set to 42
[2023-11-07 15:31:22,053][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231107_153123-marq7bsh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_8192_downsample_2_unet_batch_size_32_augs
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/marq7bsh
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type              â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN         â”‚ 44.7 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram    â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet              â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder     â”‚ 20.3 M â”‚
â”‚ 4 â”‚ model.loss_fn           â”‚ BCEWithLogitsLoss â”‚      0 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 44.7 M                                                        
Non-trainable params: 0                                                         
Total params: 44.7 M                                                            
Total estimated model params size (MB): 178                                     
Epoch 0, global step 59: 'val_loss' reached 0.18558 (best 0.18558), saving model to './child-mind-institute-detect-sleep-states/marq7bsh/checkpoints/epoch=0-step=59.ckpt' as top 1
Saved best model inf -> 0.18528589393411363
Epoch 1, global step 118: 'val_loss' reached 0.10955 (best 0.10955), saving model to './child-mind-institute-detect-sleep-states/marq7bsh/checkpoints/epoch=1-step=118.ckpt' as top 1
Saved best model 0.18528589393411363 -> 0.10941488721540996
Epoch 2, global step 177: 'val_loss' reached 0.07745 (best 0.07745), saving model to './child-mind-institute-detect-sleep-states/marq7bsh/checkpoints/epoch=2-step=177.ckpt' as top 1
Saved best model 0.10941488721540996 -> 0.077433173677751
Epoch 3, global step 236: 'val_loss' was not in top 1
Epoch 4, global step 295: 'val_loss' reached 0.07595 (best 0.07595), saving model to './child-mind-institute-detect-sleep-states/marq7bsh/checkpoints/epoch=4-step=295.ckpt' as top 1
Saved best model 0.077433173677751 -> 0.07582811013396297
Epoch 5, global step 354: 'val_loss' reached 0.05795 (best 0.05795), saving model to './child-mind-institute-detect-sleep-states/marq7bsh/checkpoints/epoch=5-step=354.ckpt' as top 1
Saved best model 0.07582811013396297 -> 0.05796140991151333
Epoch 6, global step 413: 'val_loss' reached 0.04248 (best 0.04248), saving model to './child-mind-institute-detect-sleep-states/marq7bsh/checkpoints/epoch=6-step=413.ckpt' as top 1
Saved best model 0.05796140991151333 -> 0.04252510644229395
Epoch 7, global step 472: 'val_loss' was not in top 1
Epoch 8, global step 531: 'val_loss' was not in top 1
Epoch 9, global step 590: 'val_loss' was not in top 1
Epoch 10, global step 649: 'val_loss' was not in top 1
Epoch 11, global step 708: 'val_loss' was not in top 1
Epoch 12, global step 767: 'val_loss' reached 0.04147 (best 0.04147), saving model to './child-mind-institute-detect-sleep-states/marq7bsh/checkpoints/epoch=12-step=767.ckpt' as top 1
Saved best model 0.04252510644229395 -> 0.04149735326479588
Epoch 13, global step 826: 'val_loss' reached 0.03223 (best 0.03223), saving model to './child-mind-institute-detect-sleep-states/marq7bsh/checkpoints/epoch=13-step=826.ckpt' as top 1
Saved best model 0.04149735326479588 -> 0.03226987724857671
Epoch 14, global step 885: 'val_loss' was not in top 1
Epoch 15, global step 944: 'val_loss' was not in top 1
Epoch 16, global step 1003: 'val_loss' was not in top 1
Epoch 17, global step 1062: 'val_loss' was not in top 1
Epoch 18, global step 1121: 'val_loss' was not in top 1
Epoch 19, global step 1180: 'val_loss' was not in top 1
Epoch 20, global step 1239: 'val_loss' was not in top 1
Epoch 21, global step 1298: 'val_loss' was not in top 1
Epoch 22, global step 1357: 'val_loss' reached 0.03012 (best 0.03012), saving model to './child-mind-institute-detect-sleep-states/marq7bsh/checkpoints/epoch=22-step=1357.ckpt' as top 1
Saved best model 0.03226987724857671 -> 0.030149294046818147
Epoch 23, global step 1416: 'val_loss' was not in top 1
Epoch 24, global step 1475: 'val_loss' was not in top 1
Epoch 25, global step 1534: 'val_loss' was not in top 1
Epoch 26, global step 1593: 'val_loss' was not in top 1
Epoch 27, global step 1652: 'val_loss' was not in top 1
Epoch 28, global step 1711: 'val_loss' was not in top 1
Epoch 29, global step 1770: 'val_loss' was not in top 1
Epoch 30, global step 1829: 'val_loss' was not in top 1
Epoch 31, global step 1888: 'val_loss' was not in top 1
Epoch 32, global step 1947: 'val_loss' was not in top 1
Epoch 33, global step 2006: 'val_loss' was not in top 1
Epoch 34, global step 2065: 'val_loss' was not in top 1
Epoch 35, global step 2124: 'val_loss' reached 0.02885 (best 0.02885), saving model to './child-mind-institute-detect-sleep-states/marq7bsh/checkpoints/epoch=35-step=2124.ckpt' as top 1
Saved best model 0.030149294046818147 -> 0.02885722669972373
Epoch 36, global step 2183: 'val_loss' was not in top 1
Epoch 37, global step 2242: 'val_loss' was not in top 1
Epoch 38, global step 2301: 'val_loss' was not in top 1
Epoch 39, global step 2360: 'val_loss' was not in top 1
Epoch 40, global step 2419: 'val_loss' was not in top 1
Epoch 41, global step 2478: 'val_loss' was not in top 1
Epoch 42, global step 2537: 'val_loss' was not in top 1
Epoch 43, global step 2596: 'val_loss' was not in top 1
Epoch 44, global step 2655: 'val_loss' was not in top 1
Epoch 45, global step 2714: 'val_loss' was not in top 1
Epoch 46, global step 2773: 'val_loss' was not in top 1
Epoch 47, global step 2832: 'val_loss' was not in top 1
Epoch 48, global step 2891: 'val_loss' was not in top 1
Epoch 49, global step 2950: 'val_loss' was not in top 1
Epoch 50, global step 3009: 'val_loss' was not in top 1
Epoch 51, global step 3068: 'val_loss' was not in top 1
Epoch 52, global step 3127: 'val_loss' was not in top 1
Epoch 53, global step 3186: 'val_loss' was not in top 1
Epoch 54, global step 3245: 'val_loss' was not in top 1
Epoch 55, global step 3304: 'val_loss' was not in top 1
Epoch 56, global step 3363: 'val_loss' was not in top 1
Epoch 57, global step 3422: 'val_loss' was not in top 1
Epoch 58, global step 3481: 'val_loss' was not in top 1
Epoch 59, global step 3540: 'val_loss' was not in top 1
Epoch 60, global step 3599: 'val_loss' was not in top 1
Epoch 61, global step 3658: 'val_loss' was not in top 1
Epoch 62, global step 3717: 'val_loss' was not in top 1
Epoch 63, global step 3776: 'val_loss' was not in top 1
Epoch 64, global step 3835: 'val_loss' was not in top 1
Epoch 65, global step 3894: 'val_loss' was not in top 1
Epoch 66, global step 3953: 'val_loss' was not in top 1
Epoch 67, global step 4012: 'val_loss' was not in top 1
Epoch 68, global step 4071: 'val_loss' was not in top 1
Epoch 69, global step 4130: 'val_loss' was not in top 1
Epoch 70, global step 4189: 'val_loss' reached 0.02359 (best 0.02359), saving model to './child-mind-institute-detect-sleep-states/marq7bsh/checkpoints/epoch=70-step=4189.ckpt' as top 1
Saved best model 0.02885722669972373 -> 0.023585317905859222
Epoch 71, global step 4248: 'val_loss' was not in top 1
Epoch 72, global step 4307: 'val_loss' was not in top 1
Epoch 73, global step 4366: 'val_loss' was not in top 1
Epoch 74, global step 4425: 'val_loss' was not in top 1
Epoch 75, global step 4484: 'val_loss' was not in top 1
Epoch 76, global step 4543: 'val_loss' was not in top 1
Epoch 77, global step 4602: 'val_loss' was not in top 1
Epoch 78, global step 4661: 'val_loss' was not in top 1
Epoch 79, global step 4720: 'val_loss' was not in top 1
`Trainer.fit` stopped: `max_steps=4720` reached.
Epoch 79/79 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 59/59 0:00:42 â€¢ 0:00:00 1.52it/s v_num: 7bsh      
                                                               val_loss: 0.037  
                                                               val_score: 0.721 
                                                               train_loss: 0.175
[2023-11-07 16:38:50,449][train.py][INFO] - Extracting and saving best weights: model_weights.pth
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:               epoch â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            lr-AdamW â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–‡â–†â–†â–†â–†â–…â–…â–…â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–
wandb:          train_loss â–ˆâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–‚â–â–â–â–â–â–‚â–â–â–â–‚â–â–â–â–â–â–â–â–â–â–â–‚â–â–â–
wandb: trainer/global_step â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            val_loss â–ˆâ–ƒâ–ƒâ–‚â–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–â–â–‚â–â–â–‚â–â–‚â–‚â–â–‚â–â–‚â–â–‚â–â–‚â–‚â–‚â–â–â–â–‚â–‚â–â–‚â–‚â–â–‚
wandb:           val_score â–â–â–â–‚â–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–…â–‡â–‡â–‡â–‡â–‡â–ˆâ–‡â–ˆâ–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb: 
wandb: Run summary:
wandb:               epoch 79
wandb:            lr-AdamW 0.0
wandb:          train_loss 0.17498
wandb: trainer/global_step 4719
wandb:            val_loss 0.0372
wandb:           val_score 0.72096
wandb: 
wandb: ğŸš€ View run duration_8192_downsample_2_unet_batch_size_32_augs at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/marq7bsh
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231107_153123-marq7bsh/logs
Global seed set to 42
[2023-11-08 12:55:04,289][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231108_125505-e7uvgi8v
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet_batch_size_64_all_data
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/e7uvgi8v
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type              â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN         â”‚ 41.9 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram    â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet              â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder     â”‚ 17.5 M â”‚
â”‚ 4 â”‚ model.loss_fn           â”‚ BCEWithLogitsLoss â”‚      0 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 41.9 M                                                        
Non-trainable params: 0                                                         
Total params: 41.9 M                                                            
Total estimated model params size (MB): 167                                     
Epoch 0, global step 74: 'val_loss' reached 0.12283 (best 0.12283), saving model to './child-mind-institute-detect-sleep-states/e7uvgi8v/checkpoints/epoch=0-step=74.ckpt' as top 1
Saved best model inf -> 0.12238774232958492
Epoch 1, global step 148: 'val_loss' reached 0.10818 (best 0.10818), saving model to './child-mind-institute-detect-sleep-states/e7uvgi8v/checkpoints/epoch=1-step=148.ckpt' as top 1
Saved best model 0.12238774232958492 -> 0.10775981720929083
Epoch 2, global step 222: 'val_loss' reached 0.09834 (best 0.09834), saving model to './child-mind-institute-detect-sleep-states/e7uvgi8v/checkpoints/epoch=2-step=222.ckpt' as top 1
Saved best model 0.10775981720929083 -> 0.0981171737964216
Epoch 3, global step 296: 'val_loss' reached 0.08873 (best 0.08873), saving model to './child-mind-institute-detect-sleep-states/e7uvgi8v/checkpoints/epoch=3-step=296.ckpt' as top 1
Saved best model 0.0981171737964216 -> 0.0886429674727352
Epoch 4, global step 370: 'val_loss' reached 0.07510 (best 0.07510), saving model to './child-mind-institute-detect-sleep-states/e7uvgi8v/checkpoints/epoch=4-step=370.ckpt' as top 1
Saved best model 0.0886429674727352 -> 0.07501164117926046
Epoch 5, global step 444: 'val_loss' reached 0.06488 (best 0.06488), saving model to './child-mind-institute-detect-sleep-states/e7uvgi8v/checkpoints/epoch=5-step=444.ckpt' as top 1
Saved best model 0.07501164117926046 -> 0.06470567360520363
Epoch 6, global step 518: 'val_loss' was not in top 1
Epoch 7, global step 592: 'val_loss' was not in top 1
Epoch 8, global step 666: 'val_loss' was not in top 1
Epoch 9, global step 740: 'val_loss' was not in top 1
Epoch 10, global step 814: 'val_loss' reached 0.05026 (best 0.05026), saving model to './child-mind-institute-detect-sleep-states/e7uvgi8v/checkpoints/epoch=10-step=814.ckpt' as top 1
Saved best model 0.06470567360520363 -> 0.05018130707015332
Epoch 11, global step 888: 'val_loss' was not in top 1
Epoch 12, global step 962: 'val_loss' reached 0.04478 (best 0.04478), saving model to './child-mind-institute-detect-sleep-states/e7uvgi8v/checkpoints/epoch=12-step=962.ckpt' as top 1
Saved best model 0.05018130707015332 -> 0.04473131402444683
Epoch 13, global step 1036: 'val_loss' reached 0.04475 (best 0.04475), saving model to './child-mind-institute-detect-sleep-states/e7uvgi8v/checkpoints/epoch=13-step=1036.ckpt' as top 1
Saved best model 0.04473131402444683 -> 0.04466894962579796
Epoch 14, global step 1110: 'val_loss' was not in top 1
Epoch 15, global step 1184: 'val_loss' was not in top 1
Epoch 16, global step 1258: 'val_loss' was not in top 1
Epoch 17, global step 1332: 'val_loss' was not in top 1
Epoch 18, global step 1406: 'val_loss' was not in top 1
Epoch 19, global step 1480: 'val_loss' reached 0.03949 (best 0.03949), saving model to './child-mind-institute-detect-sleep-states/e7uvgi8v/checkpoints/epoch=19-step=1480.ckpt' as top 1
Saved best model 0.04466894962579796 -> 0.0394223118445983
Epoch 20, global step 1554: 'val_loss' was not in top 1
Epoch 21, global step 1628: 'val_loss' was not in top 1
Epoch 22, global step 1702: 'val_loss' was not in top 1
Epoch 23, global step 1776: 'val_loss' reached 0.03476 (best 0.03476), saving model to './child-mind-institute-detect-sleep-states/e7uvgi8v/checkpoints/epoch=23-step=1776.ckpt' as top 1
Saved best model 0.0394223118445983 -> 0.034742542787602075
Epoch 24, global step 1850: 'val_loss' was not in top 1
Epoch 25, global step 1924: 'val_loss' was not in top 1
Epoch 26, global step 1998: 'val_loss' was not in top 1
Epoch 27, global step 2072: 'val_loss' reached 0.03190 (best 0.03190), saving model to './child-mind-institute-detect-sleep-states/e7uvgi8v/checkpoints/epoch=27-step=2072.ckpt' as top 1
Saved best model 0.034742542787602075 -> 0.031848786074030945
Epoch 28, global step 2146: 'val_loss' was not in top 1
Epoch 29, global step 2220: 'val_loss' was not in top 1
Epoch 30, global step 2294: 'val_loss' was not in top 1
Epoch 31, global step 2368: 'val_loss' reached 0.03164 (best 0.03164), saving model to './child-mind-institute-detect-sleep-states/e7uvgi8v/checkpoints/epoch=31-step=2368.ckpt' as top 1
Saved best model 0.031848786074030945 -> 0.0315618414713658
Epoch 32, global step 2442: 'val_loss' was not in top 1
python: can't open file '/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/train.py': [Errno 2] No such file or directory
Global seed set to 42
[2023-11-08 20:23:27,894][train.py][INFO] - Set Up DataModule
Error executing job with overrides: []
Traceback (most recent call last):
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/run/train.py", line 32, in main
    model = SegModel(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/modelmodule/seg.py", line 31, in __init__
    self.model = get_model(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/models/common.py", line 131, in get_model
    encoder = get_encoder(cfg, feature_extractor.out_chans)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/models/common.py", line 121, in get_encoder
    return smp.model.PAN(cfg.model.encoder_name, cfg.model.encoder_weights, in_channels=in_channels, classes=1)
AttributeError: module 'segmentation_models_pytorch' has no attribute 'model'

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Global seed set to 42
[2023-11-08 20:23:54,514][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231108_202355-28b66l53
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_pan
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/28b66l53
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type              â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN         â”‚ 39.0 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram    â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ PAN               â”‚ 21.5 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder     â”‚ 17.5 M â”‚
â”‚ 4 â”‚ model.loss_fn           â”‚ BCEWithLogitsLoss â”‚      0 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 39.0 M                                                        
Non-trainable params: 0                                                         
Total params: 39.0 M                                                            
Total estimated model params size (MB): 155                                     
Epoch 0/79                                    0/119 0:00:03 â€¢ -:--:-- 0.00it/s 
Error executing job with overrides: []
Traceback (most recent call last):
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/run/train.py", line 75, in main
    trainer.fit(model, datamodule=datamodule)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 532, in fit
    call._call_and_handle_interrupt(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 571, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 980, in _run
    results = self._run_stage()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1023, in _run_stage
    self.fit_loop.run()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 202, in run
    self.advance()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 355, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 133, in run
    self.advance(data_fetcher)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 219, in advance
    batch_output = self.automatic_optimization.run(trainer.optimizers[0], kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 188, in run
    self._optimizer_step(kwargs.get("batch_idx", 0), closure)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 266, in _optimizer_step
    call._call_lightning_module_hook(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 146, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1276, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/core/optimizer.py", line 161, in step
    step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 231, in optimizer_step
    return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/amp.py", line 76, in optimizer_step
    closure_result = closure()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 142, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 128, in closure
    step_output = self._step_fn()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 315, in _training_step
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 294, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 380, in training_step
    return self.model.training_step(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/modelmodule/seg.py", line 47, in training_step
    return self.__share_step(batch, "train")
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/modelmodule/seg.py", line 60, in __share_step
    output = self.model(batch["feature"], batch["label"], do_mixup, do_cutmix)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/models/spec2Dcnn.py", line 49, in forward
    x = self.encoder(x).squeeze(1)  # (batch_size, height, n_timesteps)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/segmentation_models_pytorch/base/model.py", line 30, in forward
    decoder_output = self.decoder(*features)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/segmentation_models_pytorch/decoders/pan/decoder.py", line 181, in forward
    x5 = self.fpa(bottleneck)  # 1/32
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/segmentation_models_pytorch/decoders/pan/decoder.py", line 109, in forward
    x3 = self.down3(x2)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/container.py", line 215, in forward
    input = module(input)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 166, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/_jit_internal.py", line 488, in fn
    return if_false(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py", line 791, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
RuntimeError: Given input size: (1x1x45). Calculated output size: (1x0x22). Output size is too small

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: 
wandb: Run history:
wandb:            lr-AdamW â–
wandb: trainer/global_step â–
wandb: 
wandb: Run summary:
wandb:            lr-AdamW 0.0005
wandb: trainer/global_step 0
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_pan at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/28b66l53
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231108_202355-28b66l53/logs
Global seed set to 42
[2023-11-08 20:26:09,982][train.py][INFO] - Set Up DataModule
Error executing job with overrides: []
Traceback (most recent call last):
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/run/train.py", line 32, in main
    model = SegModel(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/modelmodule/seg.py", line 31, in __init__
    self.model = get_model(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/models/common.py", line 131, in get_model
    encoder = get_encoder(cfg, feature_extractor.out_chans)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/models/common.py", line 117, in get_encoder
    return smp.UnetPlusPlus(cfg.model.encoder_name, cfg.model.encoder_weights, in_channels=in_channels, classes=1)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/segmentation_models_pytorch/decoders/unetplusplus/model.py", line 82, in __init__
    encoder_channels=self.encoder.out_channels,
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/segmentation_models_pytorch/encoders/_base.py", line 20, in out_channels
    return self._out_channels[: self._depth + 1]
TypeError: can only concatenate str (not "int") to str

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Global seed set to 42
[2023-11-08 20:31:03,551][train.py][INFO] - Set Up DataModule
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_pan', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet++', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
Error executing job with overrides: []
Traceback (most recent call last):
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/run/train.py", line 32, in main
    model = SegModel(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/modelmodule/seg.py", line 31, in __init__
    self.model = get_model(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/models/common.py", line 133, in get_model
    encoder = get_encoder(cfg, feature_extractor.out_chans)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/models/common.py", line 119, in get_encoder
    return smp.UnetPlusPlus(cfg.model.encoder_name, cfg.model.encoder_weights, in_channels=in_channels, classes=1)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/segmentation_models_pytorch/decoders/unetplusplus/model.py", line 82, in __init__
    encoder_channels=self.encoder.out_channels,
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/segmentation_models_pytorch/encoders/_base.py", line 20, in out_channels
    return self._out_channels[: self._depth + 1]
TypeError: can only concatenate str (not "int") to str

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Global seed set to 42
[2023-11-08 20:32:13,657][train.py][INFO] - Set Up DataModule
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_pan', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
Error executing job with overrides: []
Traceback (most recent call last):
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/run/train.py", line 32, in main
    model = SegModel(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/modelmodule/seg.py", line 31, in __init__
    self.model = get_model(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/models/common.py", line 133, in get_model
    encoder = get_encoder(cfg, feature_extractor.out_chans)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/models/common.py", line 117, in get_encoder
    return smp.Unet(cfg.model.encoder_name, cfg.model.encoder_weights, in_channels=in_channels, classes=1)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/segmentation_models_pytorch/decoders/unet/model.py", line 79, in __init__
    encoder_channels=self.encoder.out_channels,
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/segmentation_models_pytorch/encoders/_base.py", line 20, in out_channels
    return self._out_channels[: self._depth + 1]
TypeError: can only concatenate str (not "int") to str

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Global seed set to 42
[2023-11-08 20:33:56,272][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231108_203357-qa23437p
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_pan
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/qa23437p
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_pan', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'pan', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type              â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN         â”‚ 39.0 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram    â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ PAN               â”‚ 21.5 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder     â”‚ 17.5 M â”‚
â”‚ 4 â”‚ model.loss_fn           â”‚ BCEWithLogitsLoss â”‚      0 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 39.0 M                                                        
Non-trainable params: 0                                                         
Total params: 39.0 M                                                            
Total estimated model params size (MB): 155                                     
Epoch 0/79                                    0/119 0:00:03 â€¢ -:--:-- 0.00it/s 
Error executing job with overrides: []
Traceback (most recent call last):
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/run/train.py", line 75, in main
    trainer.fit(model, datamodule=datamodule)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 532, in fit
    call._call_and_handle_interrupt(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 571, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 980, in _run
    results = self._run_stage()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1023, in _run_stage
    self.fit_loop.run()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 202, in run
    self.advance()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 355, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 133, in run
    self.advance(data_fetcher)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 219, in advance
    batch_output = self.automatic_optimization.run(trainer.optimizers[0], kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 188, in run
    self._optimizer_step(kwargs.get("batch_idx", 0), closure)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 266, in _optimizer_step
    call._call_lightning_module_hook(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 146, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1276, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/core/optimizer.py", line 161, in step
    step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 231, in optimizer_step
    return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/amp.py", line 76, in optimizer_step
    closure_result = closure()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 142, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 128, in closure
    step_output = self._step_fn()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 315, in _training_step
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 294, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 380, in training_step
    return self.model.training_step(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/modelmodule/seg.py", line 47, in training_step
    return self.__share_step(batch, "train")
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/modelmodule/seg.py", line 60, in __share_step
    output = self.model(batch["feature"], batch["label"], do_mixup, do_cutmix)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/models/spec2Dcnn.py", line 49, in forward
    x = self.encoder(x).squeeze(1)  # (batch_size, height, n_timesteps)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/segmentation_models_pytorch/base/model.py", line 30, in forward
    decoder_output = self.decoder(*features)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/segmentation_models_pytorch/decoders/pan/decoder.py", line 181, in forward
    x5 = self.fpa(bottleneck)  # 1/32
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/segmentation_models_pytorch/decoders/pan/decoder.py", line 109, in forward
    x3 = self.down3(x2)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/container.py", line 215, in forward
    input = module(input)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/pooling.py", line 166, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/_jit_internal.py", line 488, in fn
    return if_false(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py", line 791, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
RuntimeError: Given input size: (1x1x45). Calculated output size: (1x0x22). Output size is too small

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: 
wandb: Run history:
wandb:            lr-AdamW â–
wandb: trainer/global_step â–
wandb: 
wandb: Run summary:
wandb:            lr-AdamW 0.0005
wandb: trainer/global_step 0
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_pan at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/qa23437p
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231108_203357-qa23437p/logs
Global seed set to 42
[2023-11-08 20:34:39,953][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231108_203441-yvwwy6h0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/yvwwy6h0
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type              â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN         â”‚ 41.9 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram    â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet              â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder     â”‚ 17.5 M â”‚
â”‚ 4 â”‚ model.loss_fn           â”‚ BCEWithLogitsLoss â”‚      0 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 41.9 M                                                        
Non-trainable params: 0                                                         
Total params: 41.9 M                                                            
Total estimated model params size (MB): 167                                     
Epoch 0, global step 119: 'val_loss' reached 0.05295 (best 0.05295), saving model to './child-mind-institute-detect-sleep-states/yvwwy6h0/checkpoints/epoch=0-step=119.ckpt' as top 1
Saved best model inf -> 0.052896184075796444
Epoch 1, global step 238: 'val_loss' was not in top 1
[rank: 0] Received SIGTERM: 15
Epoch 2/79 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 119/119 0:00:28 â€¢        4.54it/s  v_num: y6h0      
                                    0:00:00                    val_loss: 0.056  
                                                               val_score: 0.195 
                                                               train_loss: 0.175
Validation                  4/151   0:00:00 â€¢        15.71it/s                  
                                    0:00:10                                     
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:               epoch â–â–â–ˆâ–ˆ
wandb:            lr-AdamW â–ˆâ–†â–
wandb:          train_loss â–ˆâ–
wandb: trainer/global_step â–â–„â–„â–…â–ˆâ–ˆâ–ˆ
wandb:            val_loss â–â–ˆ
wandb:           val_score â–â–ˆ
wandb: 
wandb: Run summary:
wandb:               epoch 1
wandb:            lr-AdamW 0.0005
wandb:          train_loss 0.17482
wandb: trainer/global_step 238
wandb:            val_loss 0.0559
wandb:           val_score 0.19455
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/yvwwy6h0
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231108_203441-yvwwy6h0/logs
Global seed set to 42
[2023-11-08 20:39:33,983][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231108_203935-7tmmfiof
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/7tmmfiof
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'manet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type              â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN         â”‚ 49.3 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram    â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ MAnet             â”‚ 31.8 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder     â”‚ 17.5 M â”‚
â”‚ 4 â”‚ model.loss_fn           â”‚ BCEWithLogitsLoss â”‚      0 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 49.3 M                                                        
Non-trainable params: 0                                                         
Total params: 49.3 M                                                            
Total estimated model params size (MB): 197                                     
Epoch 0, global step 119: 'val_loss' reached 0.05853 (best 0.05853), saving model to './child-mind-institute-detect-sleep-states/7tmmfiof/checkpoints/epoch=0-step=119.ckpt' as top 1
Saved best model inf -> 0.05847789128218463
[rank: 0] Received SIGTERM: 15
Epoch 1/79 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 119/119 0:00:30 â€¢        4.26it/s  v_num: fiof      
                                    0:00:00                    val_loss: 0.059  
                                                               val_score: 0.024 
                                                               train_loss: 0.245
Validation â”â”â”â”             41/151  0:00:02 â€¢        14.65it/s                  
                                    0:00:08                                     
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:               epoch â–â–
wandb:            lr-AdamW â–ˆâ–
wandb:          train_loss â–
wandb: trainer/global_step â–â–ˆâ–ˆâ–ˆ
wandb:            val_loss â–
wandb:           val_score â–
wandb: 
wandb: Run summary:
wandb:               epoch 0
wandb:            lr-AdamW 0.0005
wandb:          train_loss 0.24477
wandb: trainer/global_step 119
wandb:            val_loss 0.05853
wandb:           val_score 0.02364
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/7tmmfiof
wandb: Synced 1 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
Traceback (most recent call last):
  File "/home/psemchyshyn/.rye/py/cpython@3.10.11/install/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/psemchyshyn/.rye/py/cpython@3.10.11/install/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/__main__.py", line 3, in <module>
    cli.cli(prog_name="python -m wandb")
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/cli/cli.py", line 102, in wrapper
    return func(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/cli/cli.py", line 279, in service
    server.serve()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/service/server.py", line 118, in serve
    mux.loop()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/service/streams.py", line 427, in loop
    raise e
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/service/streams.py", line 425, in loop
    self._loop()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/service/streams.py", line 418, in _loop
    self._process_action(action)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/service/streams.py", line 395, in _process_action
    self._process_teardown(action)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/service/streams.py", line 373, in _process_teardown
    self._finish_all(streams_copy, exit_code)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/service/streams.py", line 352, in _finish_all
    Run._footer(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 3350, in _footer
    Run._footer_log_dir_info(quiet=quiet, settings=settings, printer=printer)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 3578, in _footer_log_dir_info
    log_dir = os.path.dirname(log_dir.replace(os.getcwd(), "."))
FileNotFoundError: [Errno 2] No such file or directory
Global seed set to 42
[2023-11-08 20:41:27,808][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231108_204129-27sr96ec
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_manet
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/27sr96ec
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_manet', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'manet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type              â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN         â”‚ 49.3 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram    â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ MAnet             â”‚ 31.8 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder     â”‚ 17.5 M â”‚
â”‚ 4 â”‚ model.loss_fn           â”‚ BCEWithLogitsLoss â”‚      0 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 49.3 M                                                        
Non-trainable params: 0                                                         
Total params: 49.3 M                                                            
Total estimated model params size (MB): 197                                     
Epoch 0, global step 119: 'val_loss' reached 0.05853 (best 0.05853), saving model to './child-mind-institute-detect-sleep-states/27sr96ec/checkpoints/epoch=0-step=119.ckpt' as top 1
Saved best model inf -> 0.05847789128218463
Epoch 1, global step 238: 'val_loss' reached 0.04268 (best 0.04268), saving model to './child-mind-institute-detect-sleep-states/27sr96ec/checkpoints/epoch=1-step=238.ckpt' as top 1
Saved best model 0.05847789128218463 -> 0.042656935973475314
Epoch 2, global step 357: 'val_loss' was not in top 1
Epoch 3, global step 476: 'val_loss' was not in top 1
Epoch 4, global step 595: 'val_loss' was not in top 1
Epoch 5, global step 714: 'val_loss' was not in top 1
[rank: 0] Received SIGTERM: 15
Epoch 6/79 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 119/119 0:00:30 â€¢        4.25it/s  v_num: 96ec      
                                    0:00:00                    val_loss: nan    
                                                               val_score: 0.0   
                                                               train_loss: 0.17 
Validation â”â”â”â”â•¸            45/151  0:00:03 â€¢        14.59it/s                  
                                    0:00:08                                     
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:               epoch â–â–â–‚â–‚â–„â–„â–…â–…â–‡â–‡â–ˆâ–ˆ
wandb:            lr-AdamW â–ˆâ–ˆâ–‡â–†â–…â–ƒâ–
wandb:          train_loss â–ˆâ–‚ â–‚â–â–
wandb: trainer/global_step â–â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–„â–„â–…â–†â–†â–†â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            val_loss â–ˆâ–    
wandb:           val_score â–‚â–ˆâ–â–â–â–
wandb: 
wandb: Run summary:
wandb:               epoch 5
wandb:            lr-AdamW 0.00049
wandb:          train_loss 0.16955
wandb: trainer/global_step 714
wandb:            val_loss nan
wandb:           val_score 0.0
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_manet at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/27sr96ec
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231108_204129-27sr96ec/logs
Global seed set to 42
[2023-11-08 20:47:13,463][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231108_204714-1cdn0l8r
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/1cdn0l8r
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type              â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN         â”‚ 41.9 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram    â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet              â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder     â”‚ 17.5 M â”‚
â”‚ 4 â”‚ model.loss_fn           â”‚ BCEWithLogitsLoss â”‚      0 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 41.9 M                                                        
Non-trainable params: 0                                                         
Total params: 41.9 M                                                            
Total estimated model params size (MB): 167                                     
Epoch 0, global step 119: 'val_loss' reached 0.05295 (best 0.05295), saving model to './child-mind-institute-detect-sleep-states/1cdn0l8r/checkpoints/epoch=0-step=119.ckpt' as top 1
Saved best model inf -> 0.052896184075796444
Epoch 1, global step 238: 'val_loss' was not in top 1
Epoch 2, global step 357: 'val_loss' reached 0.04231 (best 0.04231), saving model to './child-mind-institute-detect-sleep-states/1cdn0l8r/checkpoints/epoch=2-step=357.ckpt' as top 1
Saved best model 0.052896184075796444 -> 0.042274823877960443
Epoch 3, global step 476: 'val_loss' reached 0.03972 (best 0.03972), saving model to './child-mind-institute-detect-sleep-states/1cdn0l8r/checkpoints/epoch=3-step=476.ckpt' as top 1
Saved best model 0.042274823877960443 -> 0.03971988273729009
Epoch 4, global step 595: 'val_loss' reached 0.03123 (best 0.03123), saving model to './child-mind-institute-detect-sleep-states/1cdn0l8r/checkpoints/epoch=4-step=595.ckpt' as top 1
Saved best model 0.03971988273729009 -> 0.031233797141270624
Epoch 5, global step 714: 'val_loss' was not in top 1
Epoch 6, global step 833: 'val_loss' was not in top 1
Epoch 7, global step 952: 'val_loss' was not in top 1
Epoch 8, global step 1071: 'val_loss' was not in top 1
Epoch 9, global step 1190: 'val_loss' reached 0.03100 (best 0.03100), saving model to './child-mind-institute-detect-sleep-states/1cdn0l8r/checkpoints/epoch=9-step=1190.ckpt' as top 1
Saved best model 0.031233797141270624 -> 0.031002178967048395
Epoch 10, global step 1309: 'val_loss' reached 0.02884 (best 0.02884), saving model to './child-mind-institute-detect-sleep-states/1cdn0l8r/checkpoints/epoch=10-step=1309.ckpt' as top 1
Saved best model 0.031002178967048395 -> 0.028825988552058177
Global seed set to 42
[2023-11-08 20:55:33,184][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231108_205534-1uwjejem
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet_train_series_250
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/1uwjejem
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet_train_series_250', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7', '03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769'], 'valid_series_ids': ['89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type              â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN         â”‚ 41.9 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram    â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet              â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder     â”‚ 17.5 M â”‚
â”‚ 4 â”‚ model.loss_fn           â”‚ BCEWithLogitsLoss â”‚      0 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 41.9 M                                                        
Non-trainable params: 0                                                         
Total params: 41.9 M                                                            
Total estimated model params size (MB): 167                                     
Epoch 11, global step 1428: 'val_loss' was not in top 1
Epoch 0, global step 134: 'val_loss' reached 0.05664 (best 0.05664), saving model to './child-mind-institute-detect-sleep-states/1uwjejem/checkpoints/epoch=0-step=134.ckpt' as top 1
Epoch 12, global step 1547: 'val_loss' was not in top 1
Saved best model inf -> 0.05656912796718033
Epoch 13, global step 1666: 'val_loss' was not in top 1
Epoch 1, global step 268: 'val_loss' reached 0.04368 (best 0.04368), saving model to './child-mind-institute-detect-sleep-states/1uwjejem/checkpoints/epoch=1-step=268.ckpt' as top 1
Saved best model 0.05656912796718033 -> 0.043633917423224526
Global seed set to 42
[2023-11-08 20:59:23,935][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231108_205925-6jk8ydx6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet_train_series_280
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/6jk8ydx6
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet_train_series_280', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7', '03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type              â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN         â”‚ 41.9 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram    â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet              â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder     â”‚ 17.5 M â”‚
â”‚ 4 â”‚ model.loss_fn           â”‚ BCEWithLogitsLoss â”‚      0 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 41.9 M                                                        
Non-trainable params: 0                                                         
Total params: 41.9 M                                                            
Total estimated model params size (MB): 167                                     
Epoch 14, global step 1785: 'val_loss' was not in top 1
Epoch 2, global step 402: 'val_loss' reached 0.03923 (best 0.03923), saving model to './child-mind-institute-detect-sleep-states/1uwjejem/checkpoints/epoch=2-step=402.ckpt' as top 1
Saved best model 0.043633917423224526 -> 0.039254269244361525
Epoch 15, global step 1904: 'val_loss' was not in top 1
Epoch 3, global step 536: 'val_loss' reached 0.03042 (best 0.03042), saving model to './child-mind-institute-detect-sleep-states/1uwjejem/checkpoints/epoch=3-step=536.ckpt' as top 1
Saved best model 0.039254269244361525 -> 0.030405007803789044
Epoch 0, global step 149: 'val_loss' reached 0.05103 (best 0.05103), saving model to './child-mind-institute-detect-sleep-states/6jk8ydx6/checkpoints/epoch=0-step=149.ckpt' as top 1
Saved best model inf -> 0.05098961388679924
Epoch 16, global step 2023: 'val_loss' was not in top 1
Epoch 4, global step 670: 'val_loss' was not in top 1
Epoch 1, global step 298: 'val_loss' reached 0.03771 (best 0.03771), saving model to './child-mind-institute-detect-sleep-states/6jk8ydx6/checkpoints/epoch=1-step=298.ckpt' as top 1
Saved best model 0.05098961388679924 -> 0.037756907374332876
Epoch 17, global step 2142: 'val_loss' reached 0.02855 (best 0.02855), saving model to './child-mind-institute-detect-sleep-states/1cdn0l8r/checkpoints/epoch=17-step=2142.ckpt' as top 1
Saved best model 0.028825988552058177 -> 0.028537365072869407
Epoch 5, global step 804: 'val_loss' was not in top 1
Epoch 2, global step 447: 'val_loss' was not in top 1
Epoch 18, global step 2261: 'val_loss' was not in top 1
Epoch 6, global step 938: 'val_loss' was not in top 1
Epoch 3, global step 596: 'val_loss' reached 0.02891 (best 0.02891), saving model to './child-mind-institute-detect-sleep-states/6jk8ydx6/checkpoints/epoch=3-step=596.ckpt' as top 1
Saved best model 0.037756907374332876 -> 0.02893671119548627
Epoch 19, global step 2380: 'val_loss' was not in top 1
Epoch 7, global step 1072: 'val_loss' reached 0.02829 (best 0.02829), saving model to './child-mind-institute-detect-sleep-states/1uwjejem/checkpoints/epoch=7-step=1072.ckpt' as top 1
Saved best model 0.030405007803789044 -> 0.028277577257632643
Epoch 20, global step 2499: 'val_loss' was not in top 1
Epoch 4, global step 745: 'val_loss' was not in top 1
Epoch 8, global step 1206: 'val_loss' was not in top 1
Epoch 21, global step 2618: 'val_loss' was not in top 1
Epoch 9, global step 1340: 'val_loss' was not in top 1
Epoch 5, global step 894: 'val_loss' was not in top 1
Epoch 22, global step 2737: 'val_loss' was not in top 1
Epoch 10, global step 1474: 'val_loss' was not in top 1
Epoch 6, global step 1043: 'val_loss' was not in top 1
Epoch 23, global step 2856: 'val_loss' was not in top 1
Epoch 11, global step 1608: 'val_loss' was not in top 1
Epoch 7, global step 1192: 'val_loss' was not in top 1
Epoch 24, global step 2975: 'val_loss' reached 0.02698 (best 0.02698), saving model to './child-mind-institute-detect-sleep-states/1cdn0l8r/checkpoints/epoch=24-step=2975.ckpt' as top 1
Saved best model 0.028537365072869407 -> 0.026997412591925916
Epoch 12, global step 1742: 'val_loss' was not in top 1
Epoch 8, global step 1341: 'val_loss' was not in top 1
Epoch 25, global step 3094: 'val_loss' was not in top 1
Epoch 13, global step 1876: 'val_loss' was not in top 1
Epoch 26, global step 3213: 'val_loss' was not in top 1
Epoch 9, global step 1490: 'val_loss' was not in top 1
Epoch 14, global step 2010: 'val_loss' reached 0.02717 (best 0.02717), saving model to './child-mind-institute-detect-sleep-states/1uwjejem/checkpoints/epoch=14-step=2010.ckpt' as top 1
Saved best model 0.028277577257632643 -> 0.027159464964053675
Epoch 27, global step 3332: 'val_loss' reached 0.02605 (best 0.02605), saving model to './child-mind-institute-detect-sleep-states/1cdn0l8r/checkpoints/epoch=27-step=3332.ckpt' as top 1
Saved best model 0.026997412591925916 -> 0.026057722379256115
Epoch 15, global step 2144: 'val_loss' was not in top 1
Epoch 10, global step 1639: 'val_loss' was not in top 1
Epoch 28, global step 3451: 'val_loss' was not in top 1
[rank: 0] Received SIGTERM: 15
Epoch 29/79 â”                10/119 0:00:09 â€¢ 0:01:11 1.54it/s v_num: 0l8r      
                                                               val_loss: 0.03   
                                                               val_score: 0.727 
                                                               train_loss: 0.163
wandb: Waiting for W&B process to finish... (success).
[rank: 0] Received SIGTERM: 15
Epoch 16/79 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 134/134 0:01:28 â€¢        1.59it/s v_num: ejem      
                                     0:00:00                   val_loss: 0.032  
                                                               val_score: 0.716 
                                                               train_loss: 0.162
Validation  â”â”â”â”â”â”â”â”â”â”â•¸      54/79   0:00:08 â€¢        6.78it/s                  
                                     0:00:04                                    
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:               epoch â–â–â–â–â–â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            lr-AdamW â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–†â–†â–†â–†â–…â–…â–…â–„â–„â–„â–ƒâ–ƒâ–ƒâ–‚â–‚â–â–
wandb:          train_loss â–ˆâ–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb: trainer/global_step â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆ
wandb:            val_loss â–‡â–ˆâ–…â–„â–‚â–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–‚â–‚â–â–‚
wandb:           val_score â–â–ƒâ–„â–ƒâ–„â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb: 
wandb: Run summary:
wandb:               epoch 28
wandb:            lr-AdamW 0.00035
wandb:          train_loss 0.16306
wandb: trainer/global_step 3451
wandb:            val_loss 0.03003
wandb:           val_score 0.72748
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/1cdn0l8r
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231108_204714-1cdn0l8r/logs
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.013 MB of 0.013 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:               epoch â–â–â–â–â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–…â–…â–…â–…â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆ
wandb:            lr-AdamW â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–†â–†â–…â–…â–„â–ƒâ–ƒâ–‚â–
wandb:          train_loss â–ˆâ–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–
wandb: trainer/global_step â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:            val_loss â–ˆâ–…â–„â–‚â–ƒâ–„â–‚â–â–â–„â–ƒâ–‚â–‚â–â–â–‚
wandb:           val_score â–â–ƒâ–ƒâ–„â–„â–„â–‡â–ˆâ–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb: 
wandb: Run summary:
wandb:               epoch 15
wandb:            lr-AdamW 0.00045
wandb:          train_loss 0.16185
wandb: trainer/global_step 2144
wandb:            val_loss 0.03226
wandb:           val_score 0.71591
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet_train_series_250 at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/1uwjejem
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231108_205534-1uwjejem/logs
Exception in thread ChkStopThr:
Traceback (most recent call last):
  File "/home/psemchyshyn/.rye/py/cpython@3.10.11/install/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
Exception in thread IntMsgThr    :
self.run()
Traceback (most recent call last):
  File "/home/psemchyshyn/.rye/py/cpython@3.10.11/install/lib/python3.10/threading.py", line 953, in run
  File "/home/psemchyshyn/.rye/py/cpython@3.10.11/install/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self._target(*self._args, **self._kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 285, in check_stop_status
    self._loop_check_status(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 223, in _loop_check_status
    local_handle = request()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/interface/interface.py", line 727, in deliver_stop_status
    self.run()
  File "/home/psemchyshyn/.rye/py/cpython@3.10.11/install/lib/python3.10/threading.py", line 953, in run
    return self._deliver_stop_status(status)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/interface/interface_shared.py", line 459, in _deliver_stop_status
    return self._deliver_record(record)
    self._target(*self._args, **self._kwargs)  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/interface/interface_shared.py", line 428, in _deliver_record

      File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 299, in check_internal_messages
handle = mailbox._deliver_record(record, interface=self)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/lib/mailbox.py", line 455, in _deliver_record
    interface._publish(record)
    self._loop_check_status(  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/interface/interface_sock.py", line 51, in _publish

  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 223, in _loop_check_status
    self._sock_client.send_record_publish(record)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/lib/sock_client.py", line 221, in send_record_publish
    local_handle = request()
    self.send_server_request(server_req)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/interface/interface.py", line 743, in deliver_internal_messages
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/lib/sock_client.py", line 155, in send_server_request
    self._send_message(msg)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/lib/sock_client.py", line 152, in _send_message
    self._sendall_with_error_handle(header + data)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/lib/sock_client.py", line 130, in _sendall_with_error_handle
        return self._deliver_internal_messages(internal_message)sent = self._sock.send(data)

  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/interface/interface_shared.py", line 481, in _deliver_internal_messages
BrokenPipeError: [Errno 32] Broken pipe
    return self._deliver_record(record)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/interface/interface_shared.py", line 428, in _deliver_record
    handle = mailbox._deliver_record(record, interface=self)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/lib/mailbox.py", line 455, in _deliver_record
    interface._publish(record)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/interface/interface_sock.py", line 51, in _publish
    self._sock_client.send_record_publish(record)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/lib/sock_client.py", line 221, in send_record_publish
    self.send_server_request(server_req)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/lib/sock_client.py", line 155, in send_server_request
    self._send_message(msg)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/lib/sock_client.py", line 152, in _send_message
    self._sendall_with_error_handle(header + data)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/wandb/sdk/lib/sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
BrokenPipeError: [Errno 32] Broken pipe
[rank: 0] Received SIGTERM: 15
Epoch 11/79 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 149/149 0:01:29 â€¢       2.28it/s  v_num: ydx6      
                                     0:00:00                   val_loss: 0.034  
                                                               val_score: 0.657 
                                                               train_loss: 0.165
Validation  â”â”â•¸              28/151  0:00:01 â€¢       15.54it/s                  
                                     0:00:08                                    
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: | 0.012 MB of 0.012 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:               epoch â–â–â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–„â–„â–…â–…â–…â–…â–†â–†â–‡â–‡â–‡â–‡â–ˆâ–ˆ
wandb:            lr-AdamW â–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–†â–…â–„â–ƒâ–‚â–
wandb:          train_loss â–ˆâ–‚â–‚â–â–â–â–â–â–â–â–
wandb: trainer/global_step â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            val_loss â–ˆâ–„â–…â–â–…â–‚â–â–‚â–ƒâ–â–‚
wandb:           val_score â–â–‚â–ƒâ–„â–ƒâ–„â–„â–…â–ˆâ–ˆâ–ˆ
wandb: 
wandb: Run summary:
wandb:               epoch 10
wandb:            lr-AdamW 0.00048
wandb:          train_loss 0.16458
wandb: trainer/global_step 1639
wandb:            val_loss 0.03364
wandb:           val_score 0.65655
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet_train_series_280 at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/6jk8ydx6
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231108_205925-6jk8ydx6/logs
Global seed set to 42
[2023-11-08 21:27:50,013][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231108_212751-yhbhvdz9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/yhbhvdz9
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet', 'loss': 'bce'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type           â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN      â”‚ 41.9 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet           â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder  â”‚ 17.5 M â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 41.9 M                                                        
Non-trainable params: 0                                                         
Total params: 41.9 M                                                            
Total estimated model params size (MB): 167                                     
Epoch 0, global step 119: 'val_loss' reached 0.05295 (best 0.05295), saving model to './child-mind-institute-detect-sleep-states/yhbhvdz9/checkpoints/epoch=0-step=119.ckpt' as top 1
Saved best model inf -> 0.052896184075796444
Epoch 1, global step 238: 'val_loss' was not in top 1
Epoch 2, global step 357: 'val_loss' reached 0.04231 (best 0.04231), saving model to './child-mind-institute-detect-sleep-states/yhbhvdz9/checkpoints/epoch=2-step=357.ckpt' as top 1
Saved best model 0.052896184075796444 -> 0.042274823877960443
Epoch 3, global step 476: 'val_loss' reached 0.03972 (best 0.03972), saving model to './child-mind-institute-detect-sleep-states/yhbhvdz9/checkpoints/epoch=3-step=476.ckpt' as top 1
Saved best model 0.042274823877960443 -> 0.03971988273729009
Epoch 4, global step 595: 'val_loss' reached 0.03123 (best 0.03123), saving model to './child-mind-institute-detect-sleep-states/yhbhvdz9/checkpoints/epoch=4-step=595.ckpt' as top 1
Saved best model 0.03971988273729009 -> 0.031233797141270624
Epoch 5, global step 714: 'val_loss' was not in top 1
Epoch 6, global step 833: 'val_loss' was not in top 1
Epoch 7, global step 952: 'val_loss' was not in top 1
Epoch 8, global step 1071: 'val_loss' was not in top 1
Global seed set to 42
[2023-11-08 21:34:23,659][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231108_213424-vpg75252
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet_train_data_250
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/vpg75252
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet_train_data_250', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet', 'loss': 'bce'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7', '03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769'], 'valid_series_ids': ['89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type           â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN      â”‚ 41.9 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet           â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder  â”‚ 17.5 M â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 41.9 M                                                        
Non-trainable params: 0                                                         
Total params: 41.9 M                                                            
Total estimated model params size (MB): 167                                     
Global seed set to 42
Epoch 9, global step 1190: 'val_loss' reached 0.03100 (best 0.03100), saving model to './child-mind-institute-detect-sleep-states/yhbhvdz9/checkpoints/epoch=9-step=1190.ckpt' as top 1
Saved best model 0.031233797141270624 -> 0.031002178967048395
Epoch 0, global step 134: 'val_loss' reached 0.05664 (best 0.05664), saving model to './child-mind-institute-detect-sleep-states/vpg75252/checkpoints/epoch=0-step=134.ckpt' as top 1
Saved best model inf -> 0.05656912796718033
[2023-11-08 21:35:48,120][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231108_213551-uuaouvu4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet_train_data_all
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/uuaouvu4
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet_train_data_all', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet', 'loss': 'bce'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7', '03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type           â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN      â”‚ 41.9 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet           â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder  â”‚ 17.5 M â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 41.9 M                                                        
Non-trainable params: 0                                                         
Total params: 41.9 M                                                            
Total estimated model params size (MB): 167                                     
Epoch 10, global step 1309: 'val_loss' reached 0.02884 (best 0.02884), saving model to './child-mind-institute-detect-sleep-states/yhbhvdz9/checkpoints/epoch=10-step=1309.ckpt' as top 1
Saved best model 0.031002178967048395 -> 0.028825988552058177
Epoch 1, global step 268: 'val_loss' reached 0.04368 (best 0.04368), saving model to './child-mind-institute-detect-sleep-states/vpg75252/checkpoints/epoch=1-step=268.ckpt' as top 1
Saved best model 0.05656912796718033 -> 0.043633917423224526
Epoch 0, global step 149: 'val_loss' reached 0.05103 (best 0.05103), saving model to './child-mind-institute-detect-sleep-states/uuaouvu4/checkpoints/epoch=0-step=149.ckpt' as top 1
Saved best model inf -> 0.05098961388679924
Epoch 11, global step 1428: 'val_loss' was not in top 1
Epoch 2, global step 402: 'val_loss' reached 0.03923 (best 0.03923), saving model to './child-mind-institute-detect-sleep-states/vpg75252/checkpoints/epoch=2-step=402.ckpt' as top 1
Saved best model 0.043633917423224526 -> 0.039254269244361525
Epoch 12, global step 1547: 'val_loss' was not in top 1
Epoch 1, global step 298: 'val_loss' reached 0.03771 (best 0.03771), saving model to './child-mind-institute-detect-sleep-states/uuaouvu4/checkpoints/epoch=1-step=298.ckpt' as top 1
Saved best model 0.05098961388679924 -> 0.037756907374332876
Epoch 3, global step 536: 'val_loss' reached 0.03042 (best 0.03042), saving model to './child-mind-institute-detect-sleep-states/vpg75252/checkpoints/epoch=3-step=536.ckpt' as top 1
Saved best model 0.039254269244361525 -> 0.030405007803789044
Epoch 13, global step 1666: 'val_loss' was not in top 1
Epoch 4, global step 670: 'val_loss' was not in top 1
Epoch 2, global step 447: 'val_loss' was not in top 1
Epoch 14, global step 1785: 'val_loss' was not in top 1
Epoch 5, global step 804: 'val_loss' was not in top 1
Epoch 3, global step 596: 'val_loss' reached 0.02891 (best 0.02891), saving model to './child-mind-institute-detect-sleep-states/uuaouvu4/checkpoints/epoch=3-step=596.ckpt' as top 1
Saved best model 0.037756907374332876 -> 0.02893671119548627
Epoch 15, global step 1904: 'val_loss' was not in top 1
Epoch 6, global step 938: 'val_loss' was not in top 1
Epoch 4, global step 745: 'val_loss' was not in top 1
Epoch 16, global step 2023: 'val_loss' was not in top 1
Epoch 7, global step 1072: 'val_loss' reached 0.02829 (best 0.02829), saving model to './child-mind-institute-detect-sleep-states/vpg75252/checkpoints/epoch=7-step=1072.ckpt' as top 1
Saved best model 0.030405007803789044 -> 0.028277577257632643
Epoch 8, global step 1206: 'val_loss' was not in top 1
Epoch 17, global step 2142: 'val_loss' reached 0.02855 (best 0.02855), saving model to './child-mind-institute-detect-sleep-states/yhbhvdz9/checkpoints/epoch=17-step=2142.ckpt' as top 1
Saved best model 0.028825988552058177 -> 0.028537365072869407
Epoch 5, global step 894: 'val_loss' was not in top 1
Epoch 9, global step 1340: 'val_loss' was not in top 1
Epoch 18, global step 2261: 'val_loss' was not in top 1
Epoch 6, global step 1043: 'val_loss' was not in top 1
Epoch 10, global step 1474: 'val_loss' was not in top 1
Epoch 19, global step 2380: 'val_loss' was not in top 1
Epoch 7, global step 1192: 'val_loss' was not in top 1
Epoch 11, global step 1608: 'val_loss' was not in top 1
Epoch 20, global step 2499: 'val_loss' was not in top 1
Epoch 12, global step 1742: 'val_loss' was not in top 1
Epoch 8, global step 1341: 'val_loss' was not in top 1
Epoch 21, global step 2618: 'val_loss' was not in top 1
Epoch 13, global step 1876: 'val_loss' was not in top 1
Epoch 9, global step 1490: 'val_loss' was not in top 1
Epoch 22, global step 2737: 'val_loss' was not in top 1
Epoch 14, global step 2010: 'val_loss' reached 0.02717 (best 0.02717), saving model to './child-mind-institute-detect-sleep-states/vpg75252/checkpoints/epoch=14-step=2010.ckpt' as top 1
Saved best model 0.028277577257632643 -> 0.027159464964053675
Epoch 10, global step 1639: 'val_loss' was not in top 1
Epoch 23, global step 2856: 'val_loss' was not in top 1
Epoch 15, global step 2144: 'val_loss' was not in top 1
Epoch 11, global step 1788: 'val_loss' was not in top 1
Epoch 24, global step 2975: 'val_loss' reached 0.02698 (best 0.02698), saving model to './child-mind-institute-detect-sleep-states/yhbhvdz9/checkpoints/epoch=24-step=2975.ckpt' as top 1
Saved best model 0.028537365072869407 -> 0.026997412591925916
Epoch 16, global step 2278: 'val_loss' was not in top 1
Epoch 25, global step 3094: 'val_loss' was not in top 1
Epoch 17, global step 2412: 'val_loss' reached 0.02446 (best 0.02446), saving model to './child-mind-institute-detect-sleep-states/vpg75252/checkpoints/epoch=17-step=2412.ckpt' as top 1
Saved best model 0.027159464964053675 -> 0.02445424076824013
Epoch 12, global step 1937: 'val_loss' was not in top 1
Epoch 26, global step 3213: 'val_loss' was not in top 1
Epoch 18, global step 2546: 'val_loss' was not in top 1
Epoch 13, global step 2086: 'val_loss' was not in top 1
Epoch 27, global step 3332: 'val_loss' reached 0.02605 (best 0.02605), saving model to './child-mind-institute-detect-sleep-states/yhbhvdz9/checkpoints/epoch=27-step=3332.ckpt' as top 1
Epoch 19, global step 2680: 'val_loss' was not in top 1
Saved best model 0.026997412591925916 -> 0.026057722379256115
Epoch 14, global step 2235: 'val_loss' reached 0.02829 (best 0.02829), saving model to './child-mind-institute-detect-sleep-states/uuaouvu4/checkpoints/epoch=14-step=2235.ckpt' as top 1
Saved best model 0.02893671119548627 -> 0.02829348111667035
Epoch 20, global step 2814: 'val_loss' was not in top 1
Epoch 28, global step 3451: 'val_loss' was not in top 1
Epoch 15, global step 2384: 'val_loss' was not in top 1
Epoch 21, global step 2948: 'val_loss' was not in top 1
Epoch 29, global step 3570: 'val_loss' was not in top 1
Epoch 22, global step 3082: 'val_loss' was not in top 1
Epoch 16, global step 2533: 'val_loss' reached 0.02711 (best 0.02711), saving model to './child-mind-institute-detect-sleep-states/uuaouvu4/checkpoints/epoch=16-step=2533.ckpt' as top 1
Saved best model 0.02829348111667035 -> 0.02711093408326982
Epoch 30, global step 3689: 'val_loss' was not in top 1
Epoch 23, global step 3216: 'val_loss' was not in top 1
Epoch 17, global step 2682: 'val_loss' reached 0.02578 (best 0.02578), saving model to './child-mind-institute-detect-sleep-states/uuaouvu4/checkpoints/epoch=17-step=2682.ckpt' as top 1
Saved best model 0.02711093408326982 -> 0.025784038125216617
Epoch 31, global step 3808: 'val_loss' reached 0.02598 (best 0.02598), saving model to './child-mind-institute-detect-sleep-states/yhbhvdz9/checkpoints/epoch=31-step=3808.ckpt' as top 1
Saved best model 0.026057722379256115 -> 0.025985706384780982
Epoch 24, global step 3350: 'val_loss' was not in top 1
Epoch 32, global step 3927: 'val_loss' was not in top 1
Epoch 18, global step 2831: 'val_loss' was not in top 1
Epoch 25, global step 3484: 'val_loss' was not in top 1
Epoch 33, global step 4046: 'val_loss' was not in top 1
Epoch 26, global step 3618: 'val_loss' was not in top 1
Epoch 19, global step 2980: 'val_loss' was not in top 1
Epoch 34, global step 4165: 'val_loss' was not in top 1
Epoch 27, global step 3752: 'val_loss' was not in top 1
Epoch 20, global step 3129: 'val_loss' was not in top 1
Epoch 35, global step 4284: 'val_loss' was not in top 1
Epoch 28, global step 3886: 'val_loss' was not in top 1
Epoch 21, global step 3278: 'val_loss' was not in top 1
Epoch 36, global step 4403: 'val_loss' was not in top 1
Epoch 29, global step 4020: 'val_loss' was not in top 1
Epoch 22, global step 3427: 'val_loss' was not in top 1
Epoch 37, global step 4522: 'val_loss' was not in top 1
Epoch 30, global step 4154: 'val_loss' was not in top 1
Epoch 23, global step 3576: 'val_loss' reached 0.02379 (best 0.02379), saving model to './child-mind-institute-detect-sleep-states/uuaouvu4/checkpoints/epoch=23-step=3576.ckpt' as top 1
Saved best model 0.025784038125216617 -> 0.023799931512534962
Epoch 31, global step 4288: 'val_loss' was not in top 1
Epoch 38, global step 4641: 'val_loss' was not in top 1
Epoch 32, global step 4422: 'val_loss' was not in top 1
Epoch 39, global step 4760: 'val_loss' was not in top 1
Epoch 24, global step 3725: 'val_loss' was not in top 1
Epoch 33, global step 4556: 'val_loss' was not in top 1
Epoch 40, global step 4879: 'val_loss' reached 0.02548 (best 0.02548), saving model to './child-mind-institute-detect-sleep-states/yhbhvdz9/checkpoints/epoch=40-step=4879.ckpt' as top 1
Saved best model 0.025985706384780982 -> 0.025500728165891193
Epoch 25, global step 3874: 'val_loss' was not in top 1
Epoch 34, global step 4690: 'val_loss' was not in top 1
Epoch 41, global step 4998: 'val_loss' was not in top 1
Epoch 26, global step 4023: 'val_loss' was not in top 1
Epoch 35, global step 4824: 'val_loss' was not in top 1
Epoch 42, global step 5117: 'val_loss' reached 0.02493 (best 0.02493), saving model to './child-mind-institute-detect-sleep-states/yhbhvdz9/checkpoints/epoch=42-step=5117.ckpt' as top 1
Saved best model 0.025500728165891193 -> 0.024942378091027603
Epoch 36, global step 4958: 'val_loss' was not in top 1
Epoch 27, global step 4172: 'val_loss' was not in top 1
Epoch 43, global step 5236: 'val_loss' was not in top 1
Epoch 37, global step 5092: 'val_loss' was not in top 1
Epoch 28, global step 4321: 'val_loss' was not in top 1
Epoch 44, global step 5355: 'val_loss' was not in top 1
Epoch 38, global step 5226: 'val_loss' reached 0.02402 (best 0.02402), saving model to './child-mind-institute-detect-sleep-states/vpg75252/checkpoints/epoch=38-step=5226.ckpt' as top 1
Saved best model 0.02445424076824013 -> 0.02400643373191168
Epoch 29, global step 4470: 'val_loss' was not in top 1
Epoch 45, global step 5474: 'val_loss' was not in top 1
Epoch 39, global step 5360: 'val_loss' was not in top 1
Epoch 46, global step 5593: 'val_loss' was not in top 1
Epoch 30, global step 4619: 'val_loss' was not in top 1
Epoch 40, global step 5494: 'val_loss' was not in top 1
Epoch 47, global step 5712: 'val_loss' was not in top 1
Epoch 41, global step 5628: 'val_loss' was not in top 1
Epoch 31, global step 4768: 'val_loss' was not in top 1
Epoch 48, global step 5831: 'val_loss' was not in top 1
Epoch 42, global step 5762: 'val_loss' was not in top 1
Epoch 32, global step 4917: 'val_loss' was not in top 1
Epoch 49, global step 5950: 'val_loss' was not in top 1
Epoch 43, global step 5896: 'val_loss' was not in top 1
Epoch 33, global step 5066: 'val_loss' was not in top 1
Epoch 44, global step 6030: 'val_loss' was not in top 1
Epoch 50, global step 6069: 'val_loss' was not in top 1
Epoch 34, global step 5215: 'val_loss' was not in top 1
Epoch 45, global step 6164: 'val_loss' was not in top 1
Epoch 51, global step 6188: 'val_loss' was not in top 1
Epoch 46, global step 6298: 'val_loss' was not in top 1
Epoch 35, global step 5364: 'val_loss' was not in top 1
Epoch 52, global step 6307: 'val_loss' was not in top 1
Epoch 47, global step 6432: 'val_loss' was not in top 1
Epoch 36, global step 5513: 'val_loss' was not in top 1
Epoch 53, global step 6426: 'val_loss' was not in top 1
Epoch 48, global step 6566: 'val_loss' was not in top 1
Epoch 54, global step 6545: 'val_loss' was not in top 1
Epoch 37, global step 5662: 'val_loss' was not in top 1
Epoch 49, global step 6700: 'val_loss' was not in top 1
Epoch 55, global step 6664: 'val_loss' was not in top 1
Epoch 50, global step 6834: 'val_loss' was not in top 1
Epoch 38, global step 5811: 'val_loss' was not in top 1
Epoch 56, global step 6783: 'val_loss' was not in top 1
Epoch 51, global step 6968: 'val_loss' was not in top 1
Epoch 39, global step 5960: 'val_loss' reached 0.02265 (best 0.02265), saving model to './child-mind-institute-detect-sleep-states/uuaouvu4/checkpoints/epoch=39-step=5960.ckpt' as top 1
Saved best model 0.023799931512534962 -> 0.02267041436893039
Epoch 57, global step 6902: 'val_loss' was not in top 1
Epoch 52, global step 7102: 'val_loss' reached 0.02340 (best 0.02340), saving model to './child-mind-institute-detect-sleep-states/vpg75252/checkpoints/epoch=52-step=7102.ckpt' as top 1
Saved best model 0.02400643373191168 -> 0.02340684428109634
Epoch 40, global step 6109: 'val_loss' was not in top 1
Epoch 58, global step 7021: 'val_loss' was not in top 1
Epoch 53, global step 7236: 'val_loss' was not in top 1
Epoch 41, global step 6258: 'val_loss' was not in top 1
Epoch 59, global step 7140: 'val_loss' was not in top 1
Epoch 54, global step 7370: 'val_loss' reached 0.02337 (best 0.02337), saving model to './child-mind-institute-detect-sleep-states/vpg75252/checkpoints/epoch=54-step=7370.ckpt' as top 1
Saved best model 0.02340684428109634 -> 0.023359379547654026
Epoch 42, global step 6407: 'val_loss' was not in top 1
Epoch 60, global step 7259: 'val_loss' was not in top 1
Epoch 55, global step 7504: 'val_loss' was not in top 1
Epoch 61, global step 7378: 'val_loss' was not in top 1
Epoch 56, global step 7638: 'val_loss' was not in top 1
Epoch 43, global step 6556: 'val_loss' was not in top 1
Epoch 62, global step 7497: 'val_loss' was not in top 1
Epoch 57, global step 7772: 'val_loss' was not in top 1
Epoch 44, global step 6705: 'val_loss' was not in top 1
Epoch 63, global step 7616: 'val_loss' reached 0.02473 (best 0.02473), saving model to './child-mind-institute-detect-sleep-states/yhbhvdz9/checkpoints/epoch=63-step=7616.ckpt' as top 1
Saved best model 0.024942378091027603 -> 0.024734759919918976
Epoch 58, global step 7906: 'val_loss' was not in top 1
Epoch 45, global step 6854: 'val_loss' was not in top 1
Epoch 59, global step 8040: 'val_loss' was not in top 1
Epoch 64, global step 7735: 'val_loss' was not in top 1
Epoch 46, global step 7003: 'val_loss' was not in top 1
Epoch 60, global step 8174: 'val_loss' was not in top 1
Epoch 65, global step 7854: 'val_loss' was not in top 1
Epoch 47, global step 7152: 'val_loss' reached 0.02257 (best 0.02257), saving model to './child-mind-institute-detect-sleep-states/uuaouvu4/checkpoints/epoch=47-step=7152.ckpt' as top 1
Saved best model 0.02267041436893039 -> 0.02258334610617368
Epoch 61, global step 8308: 'val_loss' was not in top 1
Epoch 66, global step 7973: 'val_loss' reached 0.02368 (best 0.02368), saving model to './child-mind-institute-detect-sleep-states/yhbhvdz9/checkpoints/epoch=66-step=7973.ckpt' as top 1
Saved best model 0.024734759919918976 -> 0.023688367053339047
Epoch 62, global step 8442: 'val_loss' was not in top 1
Epoch 48, global step 7301: 'val_loss' was not in top 1
Epoch 67, global step 8092: 'val_loss' was not in top 1
Epoch 63, global step 8576: 'val_loss' was not in top 1
Epoch 49, global step 7450: 'val_loss' was not in top 1
Epoch 68, global step 8211: 'val_loss' was not in top 1
Epoch 64, global step 8710: 'val_loss' was not in top 1
Epoch 69, global step 8330: 'val_loss' was not in top 1
Epoch 50, global step 7599: 'val_loss' was not in top 1
Epoch 65, global step 8844: 'val_loss' was not in top 1
Epoch 70, global step 8449: 'val_loss' was not in top 1
Epoch 66, global step 8978: 'val_loss' was not in top 1
Epoch 51, global step 7748: 'val_loss' was not in top 1
Epoch 71, global step 8568: 'val_loss' was not in top 1
Epoch 67, global step 9112: 'val_loss' was not in top 1
Epoch 52, global step 7897: 'val_loss' reached 0.02150 (best 0.02150), saving model to './child-mind-institute-detect-sleep-states/uuaouvu4/checkpoints/epoch=52-step=7897.ckpt' as top 1
Saved best model 0.02258334610617368 -> 0.021525278507842874
Epoch 72, global step 8687: 'val_loss' was not in top 1
Epoch 68, global step 9246: 'val_loss' was not in top 1
Epoch 53, global step 8046: 'val_loss' was not in top 1
Epoch 73, global step 8806: 'val_loss' was not in top 1
Epoch 69, global step 9380: 'val_loss' was not in top 1
Epoch 54, global step 8195: 'val_loss' was not in top 1
Epoch 74, global step 8925: 'val_loss' was not in top 1
Epoch 70, global step 9514: 'val_loss' was not in top 1
Epoch 55, global step 8344: 'val_loss' was not in top 1
Epoch 75, global step 9044: 'val_loss' was not in top 1
Epoch 71, global step 9648: 'val_loss' was not in top 1
Epoch 76, global step 9163: 'val_loss' was not in top 1
Epoch 72, global step 9782: 'val_loss' was not in top 1
Epoch 56, global step 8493: 'val_loss' was not in top 1
Epoch 73, global step 9916: 'val_loss' was not in top 1
Epoch 77, global step 9282: 'val_loss' was not in top 1
Epoch 57, global step 8642: 'val_loss' reached 0.02101 (best 0.02101), saving model to './child-mind-institute-detect-sleep-states/uuaouvu4/checkpoints/epoch=57-step=8642.ckpt' as top 1
Saved best model 0.021525278507842874 -> 0.021032529620959466
Epoch 74, global step 10050: 'val_loss' was not in top 1
Epoch 78, global step 9401: 'val_loss' was not in top 1
Epoch 58, global step 8791: 'val_loss' was not in top 1
Epoch 75, global step 10184: 'val_loss' was not in top 1
Epoch 79, global step 9520: 'val_loss' was not in top 1
`Trainer.fit` stopped: `max_steps=9520` reached.
Epoch 79/79 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 119/119 0:01:19 â€¢        1.64it/s v_num: vdz9      
                                     0:00:00                   val_loss: 0.025  
                                                               val_score: 0.747 
                                                               train_loss: 0.155
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet', 'loss': 'bce'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
[2023-11-08 23:49:25,809][train.py][INFO] - Extracting and saving best weights: model_weights.pth
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:               epoch â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            lr-AdamW â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–‡â–†â–†â–†â–†â–…â–…â–…â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–
wandb:          train_loss â–ˆâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb: trainer/global_step â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            val_loss â–ˆâ–…â–ƒâ–„â–ƒâ–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–‚â–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–â–â–‚â–‚â–‚â–â–‚â–â–‚â–‚â–â–â–‚â–â–â–â–â–â–â–
wandb:           val_score â–â–„â–„â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb: 
wandb: Run summary:
wandb:               epoch 79
wandb:            lr-AdamW 0.0
wandb:          train_loss 0.15453
wandb: trainer/global_step 9519
wandb:            val_loss 0.02454
wandb:           val_score 0.74657
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/yhbhvdz9
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231108_212751-yhbhvdz9/logs
Epoch 59, global step 8940: 'val_loss' reached 0.02095 (best 0.02095), saving model to './child-mind-institute-detect-sleep-states/uuaouvu4/checkpoints/epoch=59-step=8940.ckpt' as top 1
Epoch 76, global step 10318: 'val_loss' was not in top 1
Saved best model 0.021032529620959466 -> 0.0209741951166868
Epoch 77, global step 10452: 'val_loss' was not in top 1
Epoch 60, global step 9089: 'val_loss' was not in top 1
Epoch 78, global step 10586: 'val_loss' was not in top 1
Epoch 61, global step 9238: 'val_loss' was not in top 1
Epoch 79, global step 10720: 'val_loss' was not in top 1
`Trainer.fit` stopped: `max_steps=10720` reached.
Epoch 79/79 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 134/134 0:00:57 â€¢        2.69it/s v_num: 5252      
                                     0:00:00                   val_loss: 0.025  
                                                               val_score: 0.724 
                                                               train_loss: 0.156
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet_train_data_250', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet', 'loss': 'bce'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7', '03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769'], 'valid_series_ids': ['89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
[2023-11-08 23:53:39,375][train.py][INFO] - Extracting and saving best weights: model_weights.pth
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.023 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.023 MB uploaded (0.000 MB deduped)wandb: | 0.023 MB of 0.023 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:               epoch â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            lr-AdamW â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–‡â–†â–†â–†â–†â–…â–…â–…â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–
wandb:          train_loss â–ˆâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb: trainer/global_step â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            val_loss â–ˆâ–„â–„â–ƒâ–‚â–„â–ƒâ–‚â–ƒâ–‚â–ƒâ–‚â–‚â–‚â–‚â–‚â–â–‚â–‚â–â–‚â–‚â–â–‚â–â–â–â–â–â–‚â–â–â–â–â–â–â–â–â–â–
wandb:           val_score â–â–ƒâ–„â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb: 
wandb: Run summary:
wandb:               epoch 79
wandb:            lr-AdamW 0.0
wandb:          train_loss 0.15603
wandb: trainer/global_step 10719
wandb:            val_loss 0.02483
wandb:           val_score 0.72389
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet_train_data_250 at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/vpg75252
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231108_213424-vpg75252/logs
Epoch 62, global step 9387: 'val_loss' reached 0.02029 (best 0.02029), saving model to './child-mind-institute-detect-sleep-states/uuaouvu4/checkpoints/epoch=62-step=9387.ckpt' as top 1
Saved best model 0.0209741951166868 -> 0.02030828313259038
Epoch 63, global step 9536: 'val_loss' was not in top 1
Epoch 64, global step 9685: 'val_loss' was not in top 1
Epoch 65, global step 9834: 'val_loss' reached 0.02019 (best 0.02019), saving model to './child-mind-institute-detect-sleep-states/uuaouvu4/checkpoints/epoch=65-step=9834.ckpt' as top 1
Saved best model 0.02030828313259038 -> 0.02020498824657391
Epoch 66, global step 9983: 'val_loss' was not in top 1
Epoch 67, global step 10132: 'val_loss' was not in top 1
Epoch 68, global step 10281: 'val_loss' was not in top 1
Epoch 69, global step 10430: 'val_loss' was not in top 1
Epoch 70, global step 10579: 'val_loss' was not in top 1
Epoch 71, global step 10728: 'val_loss' was not in top 1
Epoch 72, global step 10877: 'val_loss' reached 0.01994 (best 0.01994), saving model to './child-mind-institute-detect-sleep-states/uuaouvu4/checkpoints/epoch=72-step=10877.ckpt' as top 1
Saved best model 0.02020498824657391 -> 0.019951833835309556
Epoch 73, global step 11026: 'val_loss' was not in top 1
Epoch 74, global step 11175: 'val_loss' was not in top 1
Epoch 75, global step 11324: 'val_loss' was not in top 1
Epoch 76, global step 11473: 'val_loss' reached 0.01992 (best 0.01992), saving model to './child-mind-institute-detect-sleep-states/uuaouvu4/checkpoints/epoch=76-step=11473.ckpt' as top 1
Saved best model 0.019951833835309556 -> 0.019935173262373256
Epoch 77, global step 11622: 'val_loss' was not in top 1
Epoch 78, global step 11771: 'val_loss' reached 0.01991 (best 0.01991), saving model to './child-mind-institute-detect-sleep-states/uuaouvu4/checkpoints/epoch=78-step=11771.ckpt' as top 1
Saved best model 0.019935173262373256 -> 0.019923157922905062
Epoch 79, global step 11920: 'val_loss' was not in top 1
`Trainer.fit` stopped: `max_steps=11920` reached.
Epoch 79/79 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 149/149 0:00:35 â€¢        4.56it/s v_num: uvu4      
                                     0:00:00                   val_loss: 0.02   
                                                               val_score: 0.789 
                                                               train_loss: 0.157
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet_train_data_all', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet', 'loss': 'bce'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7', '03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
[2023-11-09 00:07:38,937][train.py][INFO] - Extracting and saving best weights: model_weights.pth
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:               epoch â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            lr-AdamW â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–‡â–†â–†â–†â–†â–…â–…â–…â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–
wandb:          train_loss â–ˆâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb: trainer/global_step â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            val_loss â–ˆâ–†â–†â–ƒâ–„â–„â–„â–ƒâ–ƒâ–ƒâ–‚â–„â–„â–‚â–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–‚â–‚â–â–â–â–â–â–â–â–â–â–
wandb:           val_score â–â–ƒâ–ƒâ–ƒâ–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb: 
wandb: Run summary:
wandb:               epoch 79
wandb:            lr-AdamW 0.0
wandb:          train_loss 0.15653
wandb: trainer/global_step 11919
wandb:            val_loss 0.01999
wandb:           val_score 0.78888
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet_train_data_all at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/uuaouvu4
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231108_213551-uuaouvu4/logs
Global seed set to 42
[2023-11-09 13:58:40,526][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231109_135841-d3ewpwng
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet_mse
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/d3ewpwng
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet_mse', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet', 'loss': 'mse'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type           â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN      â”‚ 41.9 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet           â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder  â”‚ 17.5 M â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 41.9 M                                                        
Non-trainable params: 0                                                         
Total params: 41.9 M                                                            
Total estimated model params size (MB): 167                                     
Epoch 0, global step 119: 'val_loss' reached 0.01287 (best 0.01287), saving model to './child-mind-institute-detect-sleep-states/d3ewpwng/checkpoints/epoch=0-step=119.ckpt' as top 1
Saved best model inf -> 0.012867666957691768
Epoch 1, global step 238: 'val_loss' reached 0.01253 (best 0.01253), saving model to './child-mind-institute-detect-sleep-states/d3ewpwng/checkpoints/epoch=1-step=238.ckpt' as top 1
Saved best model 0.012867666957691768 -> 0.012531146074842587
Global seed set to 42
[2023-11-09 14:05:22,886][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231109_140524-1shfli17
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet_kld
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/1shfli17
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet_kld', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet', 'loss': 'kld'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type           â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN      â”‚ 41.9 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet           â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder  â”‚ 17.5 M â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 41.9 M                                                        
Non-trainable params: 0                                                         
Total params: 41.9 M                                                            
Total estimated model params size (MB): 167                                     
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 2, global step 357: 'val_loss' reached 0.01029 (best 0.01029), saving model to './child-mind-institute-detect-sleep-states/d3ewpwng/checkpoints/epoch=2-step=357.ckpt' as top 1
Saved best model 0.012531146074842587 -> 0.01029692259766042
Epoch 0, global step 119: 'val_loss' reached -1.69074 (best -1.69074), saving model to './child-mind-institute-detect-sleep-states/1shfli17/checkpoints/epoch=0-step=119.ckpt' as top 1
Saved best model inf -> -1.693611206795206
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 1, global step 238: 'val_loss' reached -5.70555 (best -5.70555), saving model to './child-mind-institute-detect-sleep-states/1shfli17/checkpoints/epoch=1-step=238.ckpt' as top 1
Saved best model -1.693611206795206 -> -5.715042874513083
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 2, global step 357: 'val_loss' reached -12.16336 (best -12.16336), saving model to './child-mind-institute-detect-sleep-states/1shfli17/checkpoints/epoch=2-step=357.ckpt' as top 1
Saved best model -5.715042874513083 -> -12.184042237452324
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 3, global step 476: 'val_loss' was not in top 1
Epoch 3, global step 476: 'val_loss' reached -21.46857 (best -21.46857), saving model to './child-mind-institute-detect-sleep-states/1shfli17/checkpoints/epoch=3-step=476.ckpt' as top 1
Saved best model -12.184042237452324 -> -21.505373878984262
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 4, global step 595: 'val_loss' reached -34.15994 (best -34.15994), saving model to './child-mind-institute-detect-sleep-states/1shfli17/checkpoints/epoch=4-step=595.ckpt' as top 1
Saved best model -21.505373878984262 -> -34.21823699426967
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 5, global step 714: 'val_loss' reached -51.14279 (best -51.14279), saving model to './child-mind-institute-detect-sleep-states/1shfli17/checkpoints/epoch=5-step=714.ckpt' as top 1
Saved best model -34.21823699426967 -> -51.22929289798863
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 6, global step 833: 'val_loss' reached -72.29041 (best -72.29041), saving model to './child-mind-institute-detect-sleep-states/1shfli17/checkpoints/epoch=6-step=833.ckpt' as top 1
Saved best model -51.22929289798863 -> -72.41229861935243
Epoch 4, global step 595: 'val_loss' reached 0.00976 (best 0.00976), saving model to './child-mind-institute-detect-sleep-states/d3ewpwng/checkpoints/epoch=4-step=595.ckpt' as top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Saved best model 0.01029692259766042 -> 0.00976836670774871
Epoch 7, global step 952: 'val_loss' reached -98.48489 (best -98.48489), saving model to './child-mind-institute-detect-sleep-states/1shfli17/checkpoints/epoch=7-step=952.ckpt' as top 1
Saved best model -72.41229861935243 -> -98.65234100266008
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 8, global step 1071: 'val_loss' reached -131.53967 (best -131.53967), saving model to './child-mind-institute-detect-sleep-states/1shfli17/checkpoints/epoch=8-step=1071.ckpt' as top 1
Saved best model -98.65234100266008 -> -131.7639054115245
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 9, global step 1190: 'val_loss' reached -171.12277 (best -171.12277), saving model to './child-mind-institute-detect-sleep-states/1shfli17/checkpoints/epoch=9-step=1190.ckpt' as top 1
Saved best model -131.7639054115245 -> -171.41022375245757
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 5, global step 714: 'val_loss' was not in top 1
Epoch 10, global step 1309: 'val_loss' reached -217.81229 (best -217.81229), saving model to './child-mind-institute-detect-sleep-states/1shfli17/checkpoints/epoch=10-step=1309.ckpt' as top 1
Saved best model -171.41022375245757 -> -218.18044553845135
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 11, global step 1428: 'val_loss' reached -270.39926 (best -270.39926), saving model to './child-mind-institute-detect-sleep-states/1shfli17/checkpoints/epoch=11-step=1428.ckpt' as top 1
Saved best model -218.18044553845135 -> -270.85651449494014
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 12, global step 1547: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 6, global step 833: 'val_loss' was not in top 1
Epoch 13, global step 1666: 'val_loss' reached -399.01880 (best -399.01880), saving model to './child-mind-institute-detect-sleep-states/1shfli17/checkpoints/epoch=13-step=1666.ckpt' as top 1
Saved best model -270.85651449494014 -> -399.69828268392195
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 14, global step 1785: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 15, global step 1904: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 16, global step 2023: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 7, global step 952: 'val_loss' reached 0.00866 (best 0.00866), saving model to './child-mind-institute-detect-sleep-states/d3ewpwng/checkpoints/epoch=7-step=952.ckpt' as top 1
Saved best model 0.00976836670774871 -> 0.008668959385654519
Epoch 17, global step 2142: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 18, global step 2261: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 19, global step 2380: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 8, global step 1071: 'val_loss' was not in top 1
Epoch 20, global step 2499: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 21, global step 2618: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 22, global step 2737: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 23, global step 2856: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 9, global step 1190: 'val_loss' was not in top 1
Epoch 24, global step 2975: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 25, global step 3094: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 26, global step 3213: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 10, global step 1309: 'val_loss' was not in top 1
Epoch 27, global step 3332: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 28, global step 3451: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 29, global step 3570: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 30, global step 3689: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 11, global step 1428: 'val_loss' was not in top 1
Epoch 31, global step 3808: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 32, global step 3927: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 33, global step 4046: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 12, global step 1547: 'val_loss' was not in top 1
Epoch 34, global step 4165: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 35, global step 4284: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 36, global step 4403: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 37, global step 4522: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 13, global step 1666: 'val_loss' was not in top 1
Epoch 38, global step 4641: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 39, global step 4760: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 40, global step 4879: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 14, global step 1785: 'val_loss' was not in top 1
Epoch 41, global step 4998: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 42, global step 5117: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 43, global step 5236: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 44, global step 5355: 'val_loss' was not in top 1
Epoch 15, global step 1904: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 45, global step 5474: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 46, global step 5593: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 47, global step 5712: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 16, global step 2023: 'val_loss' was not in top 1
Epoch 48, global step 5831: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 49, global step 5950: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 50, global step 6069: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 17, global step 2142: 'val_loss' was not in top 1
Epoch 51, global step 6188: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 52, global step 6307: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 53, global step 6426: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 54, global step 6545: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 18, global step 2261: 'val_loss' was not in top 1
Epoch 55, global step 6664: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 56, global step 6783: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 57, global step 6902: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 19, global step 2380: 'val_loss' was not in top 1
Epoch 58, global step 7021: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 59, global step 7140: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 60, global step 7259: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 20, global step 2499: 'val_loss' was not in top 1
Epoch 61, global step 7378: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 62, global step 7497: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 63, global step 7616: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 21, global step 2618: 'val_loss' was not in top 1
Epoch 64, global step 7735: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 65, global step 7854: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 66, global step 7973: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 22, global step 2737: 'val_loss' was not in top 1
Epoch 67, global step 8092: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 68, global step 8211: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 69, global step 8330: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 23, global step 2856: 'val_loss' was not in top 1
Epoch 70, global step 8449: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 71, global step 8568: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 72, global step 8687: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 73, global step 8806: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 24, global step 2975: 'val_loss' reached 0.00845 (best 0.00845), saving model to './child-mind-institute-detect-sleep-states/d3ewpwng/checkpoints/epoch=24-step=2975.ckpt' as top 1
Saved best model 0.008668959385654519 -> 0.00845388413887989
Epoch 74, global step 8925: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 75, global step 9044: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 76, global step 9163: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 25, global step 3094: 'val_loss' was not in top 1
Epoch 77, global step 9282: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 78, global step 9401: 'val_loss' was not in top 1
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
Epoch 79, global step 9520: 'val_loss' was not in top 1
`Trainer.fit` stopped: `max_steps=9520` reached.
Epoch 79/79 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 119/119 0:00:31 â€¢        3.97it/s v_num: li17      
                                     0:00:00                   val_loss: nan    
                                                               val_score: 0.0   
                                                               train_loss: nan  
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet_kld', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet', 'loss': 'kld'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
[2023-11-09 15:22:15,270][train.py][INFO] - Extracting and saving best weights: model_weights.pth
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:               epoch â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            lr-AdamW â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–‡â–†â–†â–†â–†â–…â–…â–…â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–
wandb:          train_loss â–ˆâ–ˆâ–‡â–†â–„â–                                  
wandb: trainer/global_step â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            val_loss â–ˆâ–ˆâ–‡â–†â–„â–                                  
wandb:           val_score â–ˆâ–â–‚â–ƒâ–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb: 
wandb: Run summary:
wandb:               epoch 79
wandb:            lr-AdamW 0.0
wandb:          train_loss nan
wandb: trainer/global_step 9519
wandb:            val_loss nan
wandb:           val_score 0.0
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet_kld at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/1shfli17
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231109_140524-1shfli17/logs
Epoch 26, global step 3213: 'val_loss' was not in top 1
Epoch 27, global step 3332: 'val_loss' reached 0.00828 (best 0.00828), saving model to './child-mind-institute-detect-sleep-states/d3ewpwng/checkpoints/epoch=27-step=3332.ckpt' as top 1
Saved best model 0.00845388413887989 -> 0.008284418647958503
Epoch 28, global step 3451: 'val_loss' was not in top 1
Epoch 29, global step 3570: 'val_loss' was not in top 1
Epoch 30, global step 3689: 'val_loss' was not in top 1
Epoch 31, global step 3808: 'val_loss' reached 0.00828 (best 0.00828), saving model to './child-mind-institute-detect-sleep-states/d3ewpwng/checkpoints/epoch=31-step=3808.ckpt' as top 1
Saved best model 0.008284418647958503 -> 0.008283429856184486
Epoch 32, global step 3927: 'val_loss' was not in top 1
Epoch 33, global step 4046: 'val_loss' was not in top 1
Epoch 34, global step 4165: 'val_loss' was not in top 1
Epoch 35, global step 4284: 'val_loss' was not in top 1
Epoch 36, global step 4403: 'val_loss' was not in top 1
Epoch 37, global step 4522: 'val_loss' was not in top 1
Epoch 38, global step 4641: 'val_loss' was not in top 1
Epoch 39, global step 4760: 'val_loss' was not in top 1
Epoch 40, global step 4879: 'val_loss' was not in top 1
Epoch 41, global step 4998: 'val_loss' reached 0.00808 (best 0.00808), saving model to './child-mind-institute-detect-sleep-states/d3ewpwng/checkpoints/epoch=41-step=4998.ckpt' as top 1
Saved best model 0.008283429856184486 -> 0.008091139770202075
Epoch 42, global step 5117: 'val_loss' reached 0.00790 (best 0.00790), saving model to './child-mind-institute-detect-sleep-states/d3ewpwng/checkpoints/epoch=42-step=5117.ckpt' as top 1
Saved best model 0.008091139770202075 -> 0.007906113465199552
Epoch 43, global step 5236: 'val_loss' was not in top 1
Epoch 44, global step 5355: 'val_loss' was not in top 1
Epoch 45, global step 5474: 'val_loss' was not in top 1
Epoch 46, global step 5593: 'val_loss' was not in top 1
Epoch 47, global step 5712: 'val_loss' was not in top 1
Epoch 48, global step 5831: 'val_loss' was not in top 1
Epoch 49, global step 5950: 'val_loss' was not in top 1
Epoch 50, global step 6069: 'val_loss' was not in top 1
Epoch 51, global step 6188: 'val_loss' was not in top 1
Epoch 52, global step 6307: 'val_loss' was not in top 1
Epoch 53, global step 6426: 'val_loss' was not in top 1
Epoch 54, global step 6545: 'val_loss' was not in top 1
Epoch 55, global step 6664: 'val_loss' was not in top 1
Epoch 56, global step 6783: 'val_loss' was not in top 1
Epoch 57, global step 6902: 'val_loss' was not in top 1
Epoch 58, global step 7021: 'val_loss' was not in top 1
Epoch 59, global step 7140: 'val_loss' was not in top 1
Epoch 60, global step 7259: 'val_loss' was not in top 1
Epoch 61, global step 7378: 'val_loss' was not in top 1
Epoch 62, global step 7497: 'val_loss' was not in top 1
Epoch 63, global step 7616: 'val_loss' was not in top 1
Epoch 64, global step 7735: 'val_loss' was not in top 1
Epoch 65, global step 7854: 'val_loss' was not in top 1
Epoch 66, global step 7973: 'val_loss' was not in top 1
python: can't open file '/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/train.py': [Errno 2] No such file or directory
Epoch 67, global step 8092: 'val_loss' was not in top 1
Global seed set to 42
[2023-11-09 16:41:44,747][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231109_164145-3zy91zrr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet_mse_bce
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/3zy91zrr
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet_mse_bce', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet', 'loss': 'mse+bce'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type           â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN      â”‚ 41.9 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet           â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder  â”‚ 17.5 M â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 41.9 M                                                        
Non-trainable params: 0                                                         
Total params: 41.9 M                                                            
Total estimated model params size (MB): 167                                     
Epoch 68, global step 8211: 'val_loss' was not in top 1
Epoch 69, global step 8330: 'val_loss' was not in top 1
Epoch 0, global step 119: 'val_loss' reached 0.63811 (best 0.63811), saving model to './child-mind-institute-detect-sleep-states/3zy91zrr/checkpoints/epoch=0-step=119.ckpt' as top 1
Saved best model inf -> 0.6380530686567951
Epoch 70, global step 8449: 'val_loss' was not in top 1
Epoch 1, global step 238: 'val_loss' was not in top 1
Epoch 71, global step 8568: 'val_loss' was not in top 1
Epoch 72, global step 8687: 'val_loss' was not in top 1
Epoch 2, global step 357: 'val_loss' reached 0.63339 (best 0.63339), saving model to './child-mind-institute-detect-sleep-states/3zy91zrr/checkpoints/epoch=2-step=357.ckpt' as top 1
Saved best model 0.6380530686567951 -> 0.6333558693626858
Epoch 73, global step 8806: 'val_loss' was not in top 1
Epoch 3, global step 476: 'val_loss' was not in top 1
Epoch 74, global step 8925: 'val_loss' was not in top 1
Epoch 75, global step 9044: 'val_loss' was not in top 1
Epoch 4, global step 595: 'val_loss' was not in top 1
Epoch 76, global step 9163: 'val_loss' was not in top 1
Epoch 5, global step 714: 'val_loss' was not in top 1
Epoch 77, global step 9282: 'val_loss' was not in top 1
Epoch 78, global step 9401: 'val_loss' was not in top 1
Epoch 6, global step 833: 'val_loss' was not in top 1
Epoch 79, global step 9520: 'val_loss' was not in top 1
`Trainer.fit` stopped: `max_steps=9520` reached.
Epoch 79/79 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 119/119 0:00:33 â€¢        3.91it/s v_num: pwng      
                                     0:00:00                   val_loss: 0.008  
                                                               val_score: 0.738 
                                                               train_loss: 0.03 
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet_mse', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet', 'loss': 'mse'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
[2023-11-09 17:04:28,819][train.py][INFO] - Extracting and saving best weights: model_weights.pth
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:               epoch â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            lr-AdamW â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–‡â–†â–†â–†â–†â–…â–…â–…â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–
wandb:          train_loss â–ˆâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–‚â–ƒâ–‚â–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–‚â–‚â–‚â–â–â–â–
wandb: trainer/global_step â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            val_loss â–ˆâ–„â–„â–„â–„â–„â–‚â–„â–‚â–‡â–ƒâ–‚â–‚â–„â–‚â–ƒâ–‚â–ƒâ–‚â–‚â–‚â–â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–‚â–‚â–‚
wandb:           val_score â–â–„â–…â–‡â–‡â–‡â–‡â–‡â–‡â–†â–‡â–‡â–‡â–†â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb: 
wandb: Run summary:
wandb:               epoch 79
wandb:            lr-AdamW 0.0
wandb:          train_loss 0.0303
wandb: trainer/global_step 9519
wandb:            val_loss 0.00838
wandb:           val_score 0.73821
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet_mse at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/d3ewpwng
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231109_135841-d3ewpwng/logs
Epoch 7, global step 952: 'val_loss' reached 0.63337 (best 0.63337), saving model to './child-mind-institute-detect-sleep-states/3zy91zrr/checkpoints/epoch=7-step=952.ckpt' as top 1
Saved best model 0.6333558693626858 -> 0.6333323942114976
Epoch 8, global step 1071: 'val_loss' was not in top 1
Epoch 9, global step 1190: 'val_loss' reached 0.63145 (best 0.63145), saving model to './child-mind-institute-detect-sleep-states/3zy91zrr/checkpoints/epoch=9-step=1190.ckpt' as top 1
Saved best model 0.6333323942114976 -> 0.6314272398980249
Epoch 10, global step 1309: 'val_loss' was not in top 1
Global seed set to 42
Epoch 11, global step 1428: 'val_loss' was not in top 1
[2023-11-09 17:15:39,781][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231109_171541-unk4i401
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet_two_labels
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/unk4i401
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet_two_labels', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet', 'loss': 'bce'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type           â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN      â”‚ 41.9 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet           â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder  â”‚ 17.5 M â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 41.9 M                                                        
Non-trainable params: 0                                                         
Total params: 41.9 M                                                            
Total estimated model params size (MB): 167                                     
Epoch 0/79 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 119/119 0:00:59 â€¢ 0:00:00 2.43it/s v_num: i401
Error executing job with overrides: []
Traceback (most recent call last):
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/run/train.py", line 75, in main
    trainer.fit(model, datamodule=datamodule)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 532, in fit
    call._call_and_handle_interrupt(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 571, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 980, in _run
    results = self._run_stage()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1023, in _run_stage
    self.fit_loop.run()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 202, in run
    self.advance()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 355, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 134, in run
    self.on_advance_end()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 249, in on_advance_end
    self.val_loop.run()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/utilities.py", line 181, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 122, in run
    return self.on_run_end()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 244, in on_run_end
    self._on_evaluation_epoch_end()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 326, in _on_evaluation_epoch_end
    call._call_lightning_module_hook(trainer, hook_name)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 146, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/modelmodule/seg.py", line 114, in on_validation_epoch_end
    preds=preds[:, :, [1, 2]],
IndexError: index 2 is out of bounds for axis 2 with size 2

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: 
wandb: Run history:
wandb:            lr-AdamW â–
wandb: trainer/global_step â–
wandb: 
wandb: Run summary:
wandb:            lr-AdamW 0.0005
wandb: trainer/global_step 0
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet_two_labels at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/unk4i401
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231109_171541-unk4i401/logs
Epoch 12, global step 1547: 'val_loss' was not in top 1
Global seed set to 42
[2023-11-09 17:18:48,642][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231109_171849-dm4f1q1t
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet_two_labels
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/dm4f1q1t
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet_two_labels', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet', 'loss': 'bce'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type           â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN      â”‚ 41.9 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet           â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder  â”‚ 17.5 M â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 41.9 M                                                        
Non-trainable params: 0                                                         
Total params: 41.9 M                                                            
Total estimated model params size (MB): 167                                     
Epoch 0/79                                    0/119 0:00:02 â€¢ -:--:-- 0.00it/s 
Error executing job with overrides: []
Traceback (most recent call last):
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/run/train.py", line 75, in main
    trainer.fit(model, datamodule=datamodule)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 532, in fit
    call._call_and_handle_interrupt(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 571, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 980, in _run
    results = self._run_stage()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1023, in _run_stage
    self.fit_loop.run()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 202, in run
    self.advance()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 355, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 133, in run
    self.advance(data_fetcher)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 219, in advance
    batch_output = self.automatic_optimization.run(trainer.optimizers[0], kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 188, in run
    self._optimizer_step(kwargs.get("batch_idx", 0), closure)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 266, in _optimizer_step
    call._call_lightning_module_hook(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 146, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1276, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/core/optimizer.py", line 161, in step
    step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 231, in optimizer_step
    return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/amp.py", line 76, in optimizer_step
    closure_result = closure()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 142, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 128, in closure
    step_output = self._step_fn()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 315, in _training_step
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 294, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 380, in training_step
    return self.model.training_step(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/modelmodule/seg.py", line 47, in training_step
    return self.__share_step(batch, "train")
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/modelmodule/seg.py", line 60, in __share_step
    output = self.model(batch["feature"], batch["label"], do_mixup, do_cutmix)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/models/spec2Dcnn.py", line 66, in forward
    loss = self.losses_objs[loss_type](logits, labels)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 725, in forward
    return F.binary_cross_entropy_with_logits(input, target,
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py", line 3193, in binary_cross_entropy_with_logits
    raise ValueError(f"Target size ({target.size()}) must be the same as input size ({input.size()})")
ValueError: Target size (torch.Size([32, 2879, 3])) must be the same as input size (torch.Size([32, 2880, 2]))

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.014 MB of 0.018 MB uploaded (0.000 MB deduped)wandb: | 0.018 MB of 0.018 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:            lr-AdamW â–
wandb: trainer/global_step â–
wandb: 
wandb: Run summary:
wandb:            lr-AdamW 0.0005
wandb: trainer/global_step 0
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet_two_labels at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/dm4f1q1t
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231109_171849-dm4f1q1t/logs
Epoch 13, global step 1666: 'val_loss' was not in top 1
Global seed set to 42
[2023-11-09 17:21:10,333][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231109_172111-kvjcsopi
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet_two_labels
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/kvjcsopi
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet_two_labels', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet', 'loss': 'bce'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type           â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN      â”‚ 41.9 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet           â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder  â”‚ 17.5 M â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 41.9 M                                                        
Non-trainable params: 0                                                         
Total params: 41.9 M                                                            
Total estimated model params size (MB): 167                                     
torch.Size([32, 2880, 2]) torch.Size([32, 2879, 3])
Epoch 0/79                                    0/119 0:00:03 â€¢ -:--:-- 0.00it/s 
Error executing job with overrides: []
Traceback (most recent call last):
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/run/train.py", line 75, in main
    trainer.fit(model, datamodule=datamodule)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 532, in fit
    call._call_and_handle_interrupt(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 571, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 980, in _run
    results = self._run_stage()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1023, in _run_stage
    self.fit_loop.run()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 202, in run
    self.advance()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 355, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 133, in run
    self.advance(data_fetcher)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 219, in advance
    batch_output = self.automatic_optimization.run(trainer.optimizers[0], kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 188, in run
    self._optimizer_step(kwargs.get("batch_idx", 0), closure)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 266, in _optimizer_step
    call._call_lightning_module_hook(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 146, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1276, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/core/optimizer.py", line 161, in step
    step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 231, in optimizer_step
    return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/amp.py", line 76, in optimizer_step
    closure_result = closure()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 142, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 128, in closure
    step_output = self._step_fn()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 315, in _training_step
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 294, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 380, in training_step
    return self.model.training_step(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/modelmodule/seg.py", line 47, in training_step
    return self.__share_step(batch, "train")
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/modelmodule/seg.py", line 60, in __share_step
    output = self.model(batch["feature"], batch["label"], do_mixup, do_cutmix)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/models/spec2Dcnn.py", line 67, in forward
    loss = self.losses_objs[loss_type](logits, labels)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 725, in forward
    return F.binary_cross_entropy_with_logits(input, target,
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py", line 3193, in binary_cross_entropy_with_logits
    raise ValueError(f"Target size ({target.size()}) must be the same as input size ({input.size()})")
ValueError: Target size (torch.Size([32, 2879, 3])) must be the same as input size (torch.Size([32, 2880, 2]))

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.004 MB of 0.018 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:            lr-AdamW â–
wandb: trainer/global_step â–
wandb: 
wandb: Run summary:
wandb:            lr-AdamW 0.0005
wandb: trainer/global_step 0
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet_two_labels at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/kvjcsopi
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231109_172111-kvjcsopi/logs
Global seed set to 42
[2023-11-09 17:22:25,001][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231109_172226-typ05d4o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet_two_labels
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/typ05d4o
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet_two_labels', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet', 'loss': 'bce'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type           â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN      â”‚ 41.9 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet           â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder  â”‚ 17.5 M â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 41.9 M                                                        
Non-trainable params: 0                                                         
Total params: 41.9 M                                                            
Total estimated model params size (MB): 167                                     
Epoch 0/79                                    0/119 0:00:02 â€¢ -:--:-- 0.00it/s 
Error executing job with overrides: []
Traceback (most recent call last):
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/run/train.py", line 75, in main
    trainer.fit(model, datamodule=datamodule)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 532, in fit
    call._call_and_handle_interrupt(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 571, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 980, in _run
    results = self._run_stage()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1023, in _run_stage
    self.fit_loop.run()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 202, in run
    self.advance()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 355, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 133, in run
    self.advance(data_fetcher)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 219, in advance
    batch_output = self.automatic_optimization.run(trainer.optimizers[0], kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 188, in run
    self._optimizer_step(kwargs.get("batch_idx", 0), closure)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 266, in _optimizer_step
    call._call_lightning_module_hook(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 146, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1276, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/core/optimizer.py", line 161, in step
    step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 231, in optimizer_step
    return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/amp.py", line 76, in optimizer_step
    closure_result = closure()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 142, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 128, in closure
    step_output = self._step_fn()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 315, in _training_step
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 294, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 380, in training_step
    return self.model.training_step(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/modelmodule/seg.py", line 47, in training_step
    return self.__share_step(batch, "train")
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/modelmodule/seg.py", line 60, in __share_step
    output = self.model(batch["feature"], batch["label"], do_mixup, do_cutmix)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/models/spec2Dcnn.py", line 67, in forward
    loss = self.losses_objs[loss_type](logits, labels)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 725, in forward
    return F.binary_cross_entropy_with_logits(input, target,
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/torch/nn/functional.py", line 3193, in binary_cross_entropy_with_logits
    raise ValueError(f"Target size ({target.size()}) must be the same as input size ({input.size()})")
ValueError: Target size (torch.Size([31, 2880, 3])) must be the same as input size (torch.Size([32, 2880, 2]))

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.017 MB uploaded (0.000 MB deduped)wandb: | 0.018 MB of 0.018 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:            lr-AdamW â–
wandb: trainer/global_step â–
wandb: 
wandb: Run summary:
wandb:            lr-AdamW 0.0005
wandb: trainer/global_step 0
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet_two_labels at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/typ05d4o
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231109_172226-typ05d4o/logs
Global seed set to 42
[2023-11-09 17:23:09,143][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231109_172310-r67259pt
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet_two_labels
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/r67259pt
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet_two_labels', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet', 'loss': 'bce'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type           â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN      â”‚ 41.9 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet           â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder  â”‚ 17.5 M â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 41.9 M                                                        
Non-trainable params: 0                                                         
Total params: 41.9 M                                                            
Total estimated model params size (MB): 167                                     
Epoch 14, global step 1785: 'val_loss' was not in top 1
Epoch 0/79 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 119/119 0:00:54 â€¢ 0:00:00 2.11it/s v_num: 59pt
Error executing job with overrides: []
Traceback (most recent call last):
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/run/train.py", line 75, in main
    trainer.fit(model, datamodule=datamodule)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 532, in fit
    call._call_and_handle_interrupt(
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 571, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 980, in _run
    results = self._run_stage()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1023, in _run_stage
    self.fit_loop.run()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 202, in run
    self.advance()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 355, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 134, in run
    self.on_advance_end()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 249, in on_advance_end
    self.val_loop.run()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/utilities.py", line 181, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 122, in run
    return self.on_run_end()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 244, in on_run_end
    self._on_evaluation_epoch_end()
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 326, in _on_evaluation_epoch_end
    call._call_lightning_module_hook(trainer, hook_name)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 146, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/src/modelmodule/seg.py", line 114, in on_validation_epoch_end
    preds=preds[:, :, [1, 2]],
IndexError: index 2 is out of bounds for axis 2 with size 2

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: 
wandb: Run history:
wandb:            lr-AdamW â–
wandb: trainer/global_step â–
wandb: 
wandb: Run summary:
wandb:            lr-AdamW 0.0005
wandb: trainer/global_step 0
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet_two_labels at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/r67259pt
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231109_172310-r67259pt/logs
Global seed set to 42
[2023-11-09 17:25:56,708][train.py][INFO] - Set Up DataModule
wandb: Currently logged in as: pavlo4340. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in ./wandb/run-20231109_172557-4fh40l8q
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run duration_5760_downsample_2_unet_two_labels
wandb: â­ï¸ View project at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states
wandb: ğŸš€ View run at https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/4fh40l8q
/home/psemchyshyn/projects/sleep-detection-other/kaggle-child-mind-institute-detect-sleep-states-main/.venv/lib/python3.10/site-packages/lightning_fabric/connector.py:554: UserWarning: 16 is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090 Ti') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet_two_labels', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet', 'loss': 'bce'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name                    â”ƒ Type           â”ƒ Params â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model                   â”‚ Spec2DCNN      â”‚ 41.9 M â”‚
â”‚ 1 â”‚ model.feature_extractor â”‚ CNNSpectrogram â”‚ 13.0 K â”‚
â”‚ 2 â”‚ model.encoder           â”‚ Unet           â”‚ 24.4 M â”‚
â”‚ 3 â”‚ model.decoder           â”‚ UNet1DDecoder  â”‚ 17.5 M â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 41.9 M                                                        
Non-trainable params: 0                                                         
Total params: 41.9 M                                                            
Total estimated model params size (MB): 167                                     
Epoch 15, global step 1904: 'val_loss' was not in top 1
Epoch 0, global step 119: 'val_loss' reached 0.00759 (best 0.00759), saving model to './child-mind-institute-detect-sleep-states/4fh40l8q/checkpoints/epoch=0-step=119.ckpt' as top 1
Saved best model inf -> 0.0075914165350479
Epoch 1, global step 238: 'val_loss' reached 0.00381 (best 0.00381), saving model to './child-mind-institute-detect-sleep-states/4fh40l8q/checkpoints/epoch=1-step=238.ckpt' as top 1
Saved best model 0.0075914165350479 -> 0.003812967795749127
Epoch 2, global step 357: 'val_loss' was not in top 1
Epoch 16, global step 2023: 'val_loss' was not in top 1
Epoch 3, global step 476: 'val_loss' reached 0.00330 (best 0.00330), saving model to './child-mind-institute-detect-sleep-states/4fh40l8q/checkpoints/epoch=3-step=476.ckpt' as top 1
Saved best model 0.003812967795749127 -> 0.0033042910292942003
Epoch 4, global step 595: 'val_loss' reached 0.00259 (best 0.00259), saving model to './child-mind-institute-detect-sleep-states/4fh40l8q/checkpoints/epoch=4-step=595.ckpt' as top 1
Saved best model 0.0033042910292942003 -> 0.002587747348037653
Epoch 5, global step 714: 'val_loss' was not in top 1
Epoch 6, global step 833: 'val_loss' was not in top 1
Epoch 17, global step 2142: 'val_loss' was not in top 1
Epoch 7, global step 952: 'val_loss' was not in top 1
Epoch 8, global step 1071: 'val_loss' was not in top 1
Epoch 9, global step 1190: 'val_loss' was not in top 1
Epoch 18, global step 2261: 'val_loss' was not in top 1
Epoch 10, global step 1309: 'val_loss' was not in top 1
Epoch 11, global step 1428: 'val_loss' was not in top 1
Epoch 12, global step 1547: 'val_loss' was not in top 1
Epoch 19, global step 2380: 'val_loss' was not in top 1
Epoch 13, global step 1666: 'val_loss' was not in top 1
Epoch 14, global step 1785: 'val_loss' was not in top 1
Epoch 15, global step 1904: 'val_loss' reached 0.00258 (best 0.00258), saving model to './child-mind-institute-detect-sleep-states/4fh40l8q/checkpoints/epoch=15-step=1904.ckpt' as top 1
Saved best model 0.002587747348037653 -> 0.002581617646327933
Epoch 16, global step 2023: 'val_loss' was not in top 1
Epoch 20, global step 2499: 'val_loss' was not in top 1
Epoch 17, global step 2142: 'val_loss' was not in top 1
Epoch 18, global step 2261: 'val_loss' was not in top 1
Epoch 19, global step 2380: 'val_loss' was not in top 1
Epoch 21, global step 2618: 'val_loss' was not in top 1
Epoch 20, global step 2499: 'val_loss' reached 0.00257 (best 0.00257), saving model to './child-mind-institute-detect-sleep-states/4fh40l8q/checkpoints/epoch=20-step=2499.ckpt' as top 1
Saved best model 0.002581617646327933 -> 0.002577193845788153
Epoch 21, global step 2618: 'val_loss' was not in top 1
Epoch 22, global step 2737: 'val_loss' was not in top 1
Epoch 23, global step 2856: 'val_loss' was not in top 1
Epoch 22, global step 2737: 'val_loss' was not in top 1
Epoch 24, global step 2975: 'val_loss' was not in top 1
Epoch 25, global step 3094: 'val_loss' was not in top 1
Epoch 26, global step 3213: 'val_loss' was not in top 1
Epoch 23, global step 2856: 'val_loss' was not in top 1
Epoch 27, global step 3332: 'val_loss' was not in top 1
Epoch 28, global step 3451: 'val_loss' reached 0.00254 (best 0.00254), saving model to './child-mind-institute-detect-sleep-states/4fh40l8q/checkpoints/epoch=28-step=3451.ckpt' as top 1
Saved best model 0.002577193845788153 -> 0.0025389286212812775
Epoch 29, global step 3570: 'val_loss' was not in top 1
Epoch 24, global step 2975: 'val_loss' reached 0.63063 (best 0.63063), saving model to './child-mind-institute-detect-sleep-states/3zy91zrr/checkpoints/epoch=24-step=2975.ckpt' as top 1
Saved best model 0.6314272398980249 -> 0.630604125806038
Epoch 30, global step 3689: 'val_loss' reached 0.00252 (best 0.00252), saving model to './child-mind-institute-detect-sleep-states/4fh40l8q/checkpoints/epoch=30-step=3689.ckpt' as top 1
Saved best model 0.0025389286212812775 -> 0.002524897056328756
Epoch 31, global step 3808: 'val_loss' reached 0.00247 (best 0.00247), saving model to './child-mind-institute-detect-sleep-states/4fh40l8q/checkpoints/epoch=31-step=3808.ckpt' as top 1
Saved best model 0.002524897056328756 -> 0.0024712654405014455
Epoch 32, global step 3927: 'val_loss' reached 0.00246 (best 0.00246), saving model to './child-mind-institute-detect-sleep-states/4fh40l8q/checkpoints/epoch=32-step=3927.ckpt' as top 1
Saved best model 0.0024712654405014455 -> 0.002466011966755213
Epoch 33, global step 4046: 'val_loss' reached 0.00240 (best 0.00240), saving model to './child-mind-institute-detect-sleep-states/4fh40l8q/checkpoints/epoch=33-step=4046.ckpt' as top 1
Saved best model 0.002466011966755213 -> 0.0024001639122790998
Epoch 25, global step 3094: 'val_loss' was not in top 1
Epoch 34, global step 4165: 'val_loss' was not in top 1
Epoch 35, global step 4284: 'val_loss' reached 0.00226 (best 0.00226), saving model to './child-mind-institute-detect-sleep-states/4fh40l8q/checkpoints/epoch=35-step=4284.ckpt' as top 1
Saved best model 0.0024001639122790998 -> 0.002265455352473196
Epoch 36, global step 4403: 'val_loss' was not in top 1
Epoch 26, global step 3213: 'val_loss' was not in top 1
Epoch 37, global step 4522: 'val_loss' was not in top 1
Epoch 38, global step 4641: 'val_loss' was not in top 1
Epoch 39, global step 4760: 'val_loss' was not in top 1
Epoch 27, global step 3332: 'val_loss' was not in top 1
Epoch 40, global step 4879: 'val_loss' was not in top 1
Epoch 41, global step 4998: 'val_loss' was not in top 1
Epoch 42, global step 5117: 'val_loss' was not in top 1
Epoch 43, global step 5236: 'val_loss' was not in top 1
Epoch 28, global step 3451: 'val_loss' was not in top 1
Epoch 44, global step 5355: 'val_loss' was not in top 1
Epoch 45, global step 5474: 'val_loss' was not in top 1
Epoch 46, global step 5593: 'val_loss' was not in top 1
Epoch 29, global step 3570: 'val_loss' was not in top 1
Epoch 47, global step 5712: 'val_loss' was not in top 1
Epoch 48, global step 5831: 'val_loss' was not in top 1
Epoch 49, global step 5950: 'val_loss' was not in top 1
Epoch 50, global step 6069: 'val_loss' reached 0.00223 (best 0.00223), saving model to './child-mind-institute-detect-sleep-states/4fh40l8q/checkpoints/epoch=50-step=6069.ckpt' as top 1
Saved best model 0.002265455352473196 -> 0.0022315401844109797
Epoch 30, global step 3689: 'val_loss' was not in top 1
Epoch 51, global step 6188: 'val_loss' was not in top 1
Epoch 52, global step 6307: 'val_loss' was not in top 1
Epoch 53, global step 6426: 'val_loss' was not in top 1
Epoch 31, global step 3808: 'val_loss' was not in top 1
Epoch 54, global step 6545: 'val_loss' was not in top 1
Epoch 55, global step 6664: 'val_loss' was not in top 1
Epoch 56, global step 6783: 'val_loss' was not in top 1
Epoch 32, global step 3927: 'val_loss' was not in top 1
Epoch 57, global step 6902: 'val_loss' was not in top 1
Epoch 58, global step 7021: 'val_loss' was not in top 1
Epoch 59, global step 7140: 'val_loss' was not in top 1
Epoch 60, global step 7259: 'val_loss' was not in top 1
Epoch 33, global step 4046: 'val_loss' was not in top 1
Epoch 61, global step 7378: 'val_loss' was not in top 1
Epoch 62, global step 7497: 'val_loss' was not in top 1
Epoch 63, global step 7616: 'val_loss' was not in top 1
Epoch 34, global step 4165: 'val_loss' was not in top 1
Epoch 64, global step 7735: 'val_loss' was not in top 1
Epoch 65, global step 7854: 'val_loss' was not in top 1
Epoch 66, global step 7973: 'val_loss' was not in top 1
Epoch 35, global step 4284: 'val_loss' was not in top 1
Epoch 67, global step 8092: 'val_loss' was not in top 1
Epoch 68, global step 8211: 'val_loss' was not in top 1
Epoch 69, global step 8330: 'val_loss' was not in top 1
Epoch 70, global step 8449: 'val_loss' was not in top 1
Epoch 36, global step 4403: 'val_loss' was not in top 1
Epoch 71, global step 8568: 'val_loss' was not in top 1
Epoch 72, global step 8687: 'val_loss' was not in top 1
Epoch 73, global step 8806: 'val_loss' was not in top 1
Epoch 37, global step 4522: 'val_loss' was not in top 1
Epoch 74, global step 8925: 'val_loss' was not in top 1
Epoch 75, global step 9044: 'val_loss' was not in top 1
Epoch 76, global step 9163: 'val_loss' was not in top 1
Epoch 38, global step 4641: 'val_loss' was not in top 1
Epoch 77, global step 9282: 'val_loss' was not in top 1
Epoch 78, global step 9401: 'val_loss' was not in top 1
Epoch 79, global step 9520: 'val_loss' was not in top 1
`Trainer.fit` stopped: `max_steps=9520` reached.
Epoch 79/79 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 119/119 0:00:33 â€¢        3.88it/s v_num: 0l8q      
                                     0:00:00                   val_loss: 0.002  
                                                               val_score: 0.66  
                                                               train_loss: 0.141
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet_two_labels', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet', 'loss': 'bce'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
[2023-11-09 18:41:57,626][train.py][INFO] - Extracting and saving best weights: model_weights.pth
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:               epoch â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            lr-AdamW â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–‡â–†â–†â–†â–†â–…â–…â–…â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–
wandb:          train_loss â–ˆâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb: trainer/global_step â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            val_loss â–ˆâ–„â–â–‚â–â–‚â–‚â–‚â–‚â–‚â–â–â–‚â–â–â–â–â–‚â–‚â–â–‚â–‚â–‚â–â–‚â–â–â–â–‚â–â–â–â–â–â–â–â–â–â–â–
wandb:           val_score â–â–„â–‡â–†â–‡â–ˆâ–‡â–ˆâ–ˆâ–ˆâ–‡â–ˆâ–ˆâ–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡
wandb: 
wandb: Run summary:
wandb:               epoch 79
wandb:            lr-AdamW 0.0
wandb:          train_loss 0.14058
wandb: trainer/global_step 9519
wandb:            val_loss 0.00242
wandb:           val_score 0.66044
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet_two_labels at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/4fh40l8q
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231109_172557-4fh40l8q/logs
Epoch 39, global step 4760: 'val_loss' was not in top 1
Epoch 40, global step 4879: 'val_loss' was not in top 1
Epoch 41, global step 4998: 'val_loss' reached 0.63033 (best 0.63033), saving model to './child-mind-institute-detect-sleep-states/3zy91zrr/checkpoints/epoch=41-step=4998.ckpt' as top 1
Saved best model 0.630604125806038 -> 0.6303062707383111
Epoch 42, global step 5117: 'val_loss' reached 0.63013 (best 0.63013), saving model to './child-mind-institute-detect-sleep-states/3zy91zrr/checkpoints/epoch=42-step=5117.ckpt' as top 1
Saved best model 0.6303062707383111 -> 0.6301141535209505
Epoch 43, global step 5236: 'val_loss' was not in top 1
Epoch 44, global step 5355: 'val_loss' was not in top 1
Epoch 45, global step 5474: 'val_loss' was not in top 1
Epoch 46, global step 5593: 'val_loss' was not in top 1
Epoch 47, global step 5712: 'val_loss' was not in top 1
Epoch 48, global step 5831: 'val_loss' was not in top 1
Epoch 49, global step 5950: 'val_loss' was not in top 1
Epoch 50, global step 6069: 'val_loss' was not in top 1
Epoch 51, global step 6188: 'val_loss' was not in top 1
Epoch 52, global step 6307: 'val_loss' was not in top 1
Epoch 53, global step 6426: 'val_loss' was not in top 1
Epoch 54, global step 6545: 'val_loss' reached 0.62958 (best 0.62958), saving model to './child-mind-institute-detect-sleep-states/3zy91zrr/checkpoints/epoch=54-step=6545.ckpt' as top 1
Saved best model 0.6301141535209505 -> 0.6295574315336366
Epoch 55, global step 6664: 'val_loss' was not in top 1
Epoch 56, global step 6783: 'val_loss' was not in top 1
Epoch 57, global step 6902: 'val_loss' was not in top 1
Epoch 58, global step 7021: 'val_loss' was not in top 1
Epoch 59, global step 7140: 'val_loss' was not in top 1
Epoch 60, global step 7259: 'val_loss' was not in top 1
Epoch 61, global step 7378: 'val_loss' was not in top 1
Epoch 62, global step 7497: 'val_loss' was not in top 1
Epoch 63, global step 7616: 'val_loss' was not in top 1
Epoch 64, global step 7735: 'val_loss' was not in top 1
Epoch 65, global step 7854: 'val_loss' was not in top 1
Epoch 66, global step 7973: 'val_loss' was not in top 1
Epoch 67, global step 8092: 'val_loss' was not in top 1
Epoch 68, global step 8211: 'val_loss' was not in top 1
Epoch 69, global step 8330: 'val_loss' was not in top 1
Epoch 70, global step 8449: 'val_loss' was not in top 1
Epoch 71, global step 8568: 'val_loss' was not in top 1
Epoch 72, global step 8687: 'val_loss' was not in top 1
Epoch 73, global step 8806: 'val_loss' was not in top 1
Epoch 74, global step 8925: 'val_loss' was not in top 1
Epoch 75, global step 9044: 'val_loss' was not in top 1
Epoch 76, global step 9163: 'val_loss' was not in top 1
Epoch 77, global step 9282: 'val_loss' was not in top 1
Epoch 78, global step 9401: 'val_loss' was not in top 1
Epoch 79, global step 9520: 'val_loss' was not in top 1
`Trainer.fit` stopped: `max_steps=9520` reached.
Epoch 79/79 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 119/119 0:00:32 â€¢        3.89it/s v_num: 1zrr      
                                     0:00:00                   val_loss: 0.63   
                                                               val_score: 0.744 
                                                               train_loss: 0.647
{'seed': 42, 'exp_name': 'duration_5760_downsample_2_unet_mse_bce', 'duration': 5760, 'downsample_rate': 2, 'upsample_rate': 1, 'epoch': 80, 'batch_size': 32, 'num_workers': 10, 'accelerator': 'auto', 'use_amp': True, 'debug': False, 'gradient_clip_val': 1.0, 'accumulate_grad_batches': 1, 'monitor': 'val_loss', 'monitor_mode': 'min', 'check_val_every_n_epoch': 1, 'offset': 10, 'sigma': 10, 'bg_sampling_rate': 0.5, 'augmentation': {'mixup_prob': 0.0, 'mixup_alpha': 0.4, 'cutmix_prob': 0.0, 'cutmix_alpha': 0.4}, 'post_process': {'score_th': 0.02, 'distance': 10}, 'labels': ['awake', 'event_onset', 'event_wakeup'], 'features': ['anglez', 'enmo', 'hour_sin', 'hour_cos'], 'optimizer': {'lr': 0.0005}, 'scheduler': {'num_warmup_steps': 0}, 'dir': {'data_dir': '/mnt/data/psemchyshyn/sleep-detection/data', 'processed_dir': '/mnt/data/psemchyshyn/sleep-detection/processed_data', 'output_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output', 'model_dir': '/mnt/data/psemchyshyn/sleep-detection/results/output/train', 'sub_dir': './'}, 'model': {'name': 'Spec2DCNN', 'architecture': 'Unet', 'encoder_name': 'resnet34', 'encoder_weights': 'imagenet', 'loss': 'mse+bce'}, 'feature_extractor': {'name': 'CNNSpectrogram', 'base_filters': 64, 'kernel_sizes': [32, 16, '${downsample_rate}'], 'stride': '${downsample_rate}', 'sigmoid': True, 'reinit': True}, 'decoder': {'name': 'UNet1DDecoder', 'bilinear': False, 'se': False, 'res': False, 'scale_factor': 2, 'dropout': 0.2}, 'split': {'train_series_ids': ['038441c925bb', '0402a003dae9', '04f547b8017d', '05e1944c3818', '062cae666e2a', '062dbd4c95e6', '08db4255286f', '0a96f4993bd7', '0ce74d6d2106', '0d0ad1e77851', '0dee4fda51c3', '0ec9fc461819', '0ef7d94fde99', '0f572d690310', '0f9e60a8e56d', '10469f6765bf', '1087d7b0ff2e', '10f8bc1f7b07', '137771d19ca2', '137b99e936ab', '13b4d6a01d27', '148471991ffb', '154fe824ed87', '16fe2798ed0f', '1716cd4163b2', '188d4b7cd28b', '18a0ca03431d', '18b61dd5aae8', '1955d568d987', '1b92be89db4c', '1c7c0bad1263', '1d4569cbac0f', '1e6717d93c1d', '1f96b9668bdf', '207eded97727', '25e2b3dd9c3b', '2654a87be968', '27f09a6a858f', '292a75c0b94e', '29d3469bd15d', '2b0a1fa8eba8', '2b8d87addea9', '2e9ced2c7976', '2f7504d0f426', '2fc653ca75c7', '31011ade7c0a', '3318a0e3ed6f', '3452b878e596', '349c5562ee2c', '361366da569e', '3664fe9233f9', '3a9a9dc2cbd9', '3aceb17ef7bd', '3be1545083b7', '3be2f86c3e45', '3c336d6ba566', '3d53bfea61d6', '3df0da2e5966', '405df1b41f9f', '40dce6018935', '416354edd92a', '449766346eb1', '44a41bba1ee7', '44d8c02b369e', '4743bdde25df', '483d6545417f', '4a31811f3558', '4ab54be1a403', '4b45c36f8f5a', '519ae2d858b0', '51b23d177971', '51c49c540b4e', '51fdcc8d9fe7', '559ffb7c166a', '55a47ff9dc8a', '5aad18e7ce64', '5acc9d63b5fd', '5c088d7e916c', '5c55a5e717d6', '5f40907ec171', '5f76965e10cf', '5ffd5e1e81ac', '60d31b0bec3b', '60e51cad2ffb', '612aa8ba44e2', '655f19eabf1e', '67f5fc60e494', '694faf956ebf', '6bf95a3cf91c', '6ca4f4fca6a2', '6d6b9d22d48a', '6ee4ade1f2bd', '702bb5387b1e', '703b5efa9bc1', '72ba4a8afff4', '72bbd1ac3edf', '72d2234e84e4', '73fb772e50fb', '7476c0bd18d2', '7504165f497d', '752900afe3a6', '77ca4db83644', '7822ee8fe3ec', '78569a801a38', '785c9ca4eff7', '7df249527c63', '7fd4284b7ee8', '804594bb1f06', '808652a666c6', '83fa182bec3a', '844f54dcab89', '854206f602d0', '87a6cbb7c4ed', '8877a6586606', '8a22387617c3', '8a306e0890c0', '8b159a98f485', '8b8b9e29171c', '8e32047cbc1f', '90eac42a9ec9', '91127c2b0e60', '91cb6c98201f', '9277be28a1cf', '927dd0c35dfd', '939932f1822d', '971207c6a525', '99237ce045e4', '9a340507e36a', '9aed9ee12ae2', '9c91c546e095', '9ee455e4770d', 'a167532acca2', 'a261bc4b7470', 'a2b0a64ec9cf', 'a3e59c2ce3f6', 'a4e48102f402', 'a596ad0b82aa', 'a681f9b04b21', 'a81f4472c637', 'a9a2f7fac455', 'a9e5f5314bcb', 'aa81faa78747', 'ad425f3ee76d', 'aed3850f65f0', 'af91d9a50547', 'b364205aba43', 'b4b75225b224', 'b7188813d58a', 'b737f8c78ec5', 'b750c8c1556c', 'b84960841a75', 'ba8083a2c3b8', 'bf00506437aa', 'bfa54bd26187', 'bfe41e96d12f', 'c107b5789660', 'c289c8a823e0', 'c3072a759efb', 'c38707ef76df', 'c535634d7dcd', 'c5365a55ebb7', 'c5d08fc3e040', 'c6788e579967', 'c68260cc9e8f', 'c75b4b207bea', 'c7b1283bb7eb', 'c7b2155a4a47', 'c7d693f24684', 'c8053490cec2', 'ca730dbf521d', 'ca732a3c37f7', 'cca14d1966c1', 'ce85771a714c', 'ce9164297046', 'cf13ed7e457a', 'cfeb11428dd7', 'd043c0ca71cd', 'd0f613c700f7', 'd150801f3145', 'd25e479ecbb7', 'd2d6b9af0553', 'd2fef7e4defd', 'd3dddd3c0e00', 'd515236bdeec', 'd5be621fd9aa', 'd5e47b94477e', 'd93b0c7de16b', 'd9e887091a5c', 'dacc6d652e35', 'db5e0ee1c0ab', 'db75092f0530', 'dc80ca623d71', 'de6fedfb6139', 'df33ae359fb5', 'dfc3ccebfdc9', 'dff367373725', 'e0686434d029', 'e0d7b0dcf9f3', 'e11b9d69f856', 'e1f2a4f991cb', 'e1f5abb82285', 'e30cb792a2bc', 'e34b496b84ce', 'e4500e7e19e1', 'e586cbfa7762', 'e69aff66e0cb', 'e6ddbaaf0639', 'e867b5133665', 'e8d0a37c3eba', 'ea0770830757', 'ebd76e93ec7d', 'ece2561f07e9', 'efbfc4526d58', 'f2c2436cf7b7', 'f6d2cc003183', 'f88e18cb4100', 'f8a8da8bdd00', 'f981a0805fd0', 'fa149c3c4bde', 'fb223ed2278c', 'fcca183903b7'], 'valid_series_ids': ['03d92c9f6f8a', '0cd1e3d0ed95', '0cfc06c129cc', '12d01911d509', '1319a1935f48', '1762ab70ec76', '280e08693c6d', '29c75c018220', '2cd2340ca14d', '2fbbee1a38e3', '33ceeba8918a', '35826366dfc7', '3665c86afaf5', '390b487231ce', '4ac356361be9', '4feda0596965', '55b7f5c99930', '599ca4ed791b', '5e816f11f5c3', '5f94bb3e1bed', '601559e1777d', '653622ac8363', '6a4cd123bd69', '76237b9406d5', '8898e6db816d', '89bd631d1769', '89c7daa72eee', '8becc76ea607', '8f6f15b9f598', '8fb18e36697d', '99b829cbad2d', '9b9cd7b7af8c', '9ddd40f2cb36', '9fbdeffbe2ba', 'a88088855de5', 'b1831c4979da', 'b7fc34995d0f', 'bb5612895813', 'bccf2f2819f8', 'bdfce9ce62b9', 'c908a0ad3e31', 'ccdee561ee5d', 'd8de352c2657', 'def21f50dd3c', 'e2a849d283c0', 'e2b60820c325', 'ebb6fae8ed43', 'ee4e0e3afd3d', 'eec197a4bdca', 'eef041dd50aa', 'f0482490923c', 'f564985ab692', 'f56824b503a0', 'f7eb179216c2', 'fbf33b1a2c10', 'fe90110788d2']}}
3 <class 'int'>
[2023-11-09 20:11:38,234][train.py][INFO] - Extracting and saving best weights: model_weights.pth
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:               epoch â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            lr-AdamW â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–‡â–†â–†â–†â–†â–…â–…â–…â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–
wandb:          train_loss â–ˆâ–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–‚â–‚â–â–â–â–â–â–â–â–â–
wandb: trainer/global_step â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:            val_loss â–ˆâ–„â–…â–…â–†â–„â–…â–„â–„â–†â–…â–ƒâ–‚â–„â–ƒâ–ƒâ–„â–ƒâ–ƒâ–‚â–‚â–â–‚â–‚â–‚â–‚â–‚â–â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–
wandb:           val_score â–â–‚â–†â–†â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–‡â–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb: 
wandb: Run summary:
wandb:               epoch 79
wandb:            lr-AdamW 0.0
wandb:          train_loss 0.64696
wandb: trainer/global_step 9519
wandb:            val_loss 0.63013
wandb:           val_score 0.74433
wandb: 
wandb: ğŸš€ View run duration_5760_downsample_2_unet_mse_bce at: https://wandb.ai/pavlo4340/child-mind-institute-detect-sleep-states/runs/3zy91zrr
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231109_164145-3zy91zrr/logs
